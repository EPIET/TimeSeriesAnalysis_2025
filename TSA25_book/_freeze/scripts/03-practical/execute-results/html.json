{
  "hash": "0875972f512a9e55641da83d6650e77e",
  "result": {
    "engine": "knitr",
    "markdown": "# Practical Session 3: Managing date formats and plotting {.unnumbered}\n\n## Expected learning outcomes {#learning-3 .unnumbered}\n\nBy the end of the session, participants should be able to:\n\n-   Manage surveillance datasets with different date formats\n\n-   Create specific time series objects using `tsibble`\n\n-   Plot surveillance data against time\n\nYou have been provided with one MS Excel file (`tsa_practice.xlsx`) containing 2 sheets, one for each of two different diseases (**dis1**, **dis2**); and one csv file called (`tsa_pumala.csv`) about Puumala virus infections in Finland.\n\n## Task 3.1\n\nAssess visually the reported number of each disease by ISO (epidemiological) week or calendar month for all the data provided (\"dis2\" is optional).\n\nWhat diseases do you think they are, judging from their distribution in time?\n\n## Help for Task 3.1 {#solution-3-1 .unnumbered}\n\nRequired source code.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Install pacman if not installed already, and activate it\nif (!require(\"pacman\")) install.packages(\"pacman\")\n\n# Install, update and activate libraries\npacman::p_load(\n  here, \n  rio, \n  skimr,\n  tsibble,\n  ISOweek,\n  tidyverse\n)\n```\n:::\n\n\nImport your data to R from these Excel files and examine it using the well-known `str`, `summary` and `skim` functions\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndis1 <- import(here(\"data\", \"tsa_practice.xlsx\"), which = \"dis1\")\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstr(dis1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n'data.frame':\t431 obs. of  3 variables:\n $ year : num  1981 1981 1981 1981 1981 ...\n $ week : num  1 2 3 4 5 6 7 8 9 10 ...\n $ cases: num  1 3 NA 4 3 2 3 4 1 NA ...\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(dis1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      year           week           cases       \n Min.   :1981   Min.   : 1.00   Min.   :  1.00  \n 1st Qu.:1983   1st Qu.:12.50   1st Qu.:  9.00  \n Median :1985   Median :26.00   Median : 28.00  \n Mean   :1985   Mean   :25.86   Mean   : 65.16  \n 3rd Qu.:1987   3rd Qu.:39.00   3rd Qu.: 83.50  \n Max.   :1989   Max.   :52.00   Max.   :554.00  \n                                NA's   :12      \n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nskim(dis1) %>% as_tibble()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 12\n  skim_type skim_variable n_missing complete_rate numeric.mean numeric.sd\n  <chr>     <chr>             <int>         <dbl>        <dbl>      <dbl>\n1 numeric   year                  0         1           1985.        2.40\n2 numeric   week                  0         1             25.9      15.2 \n3 numeric   cases                12         0.972         65.2      96.3 \n# ℹ 6 more variables: numeric.p0 <dbl>, numeric.p25 <dbl>, numeric.p50 <dbl>,\n#   numeric.p75 <dbl>, numeric.p100 <dbl>, numeric.hist <chr>\n```\n\n\n:::\n:::\n\n\nSince we will work with time series data, we could use some time to explore the most relevant variable: **date** (in this case, the `year` variable). `dis1` is a dataset containing weekly counts of a certain disease between 1981 and 1989. A typical year has 52 weeks, thus we can count the number of times each year appear in the data using `table`, `tabyl` or `count` function, your to-go tools for categorical variables\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(dis1$year)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n1981 1982 1983 1984 1985 1986 1987 1988 1989 \n  52   52   52   52   52   52   52   52   15 \n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\njanitor::tabyl(dis1$year)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n dis1$year  n    percent\n      1981 52 0.12064965\n      1982 52 0.12064965\n      1983 52 0.12064965\n      1984 52 0.12064965\n      1985 52 0.12064965\n      1986 52 0.12064965\n      1987 52 0.12064965\n      1988 52 0.12064965\n      1989 15 0.03480278\n```\n\n\n:::\n:::\n\n\nEach one provides different outputs and possesses unique capabilities. In general, `tabyl` should be your preferred basic function, thanks to its tidy integration and format output. It also enables some customization and data manipulation.\n\n------------------------------------------------------------------------\n\nR has a collection of packages for handling time series data.\n\nSome of these packages are part of the `tidyverts` family of packages. Particularly, it includes the `tsibble` package, which intends to create a data infrastructure for easier manipulation and handling of temporal data, and adapts the [principles of the](https://tidyr.tidyverse.org/articles/tidy-data.html)).\n\nAccording to the help description, a `tsibble` object is defined by\n\n-   an `index`, as a variable with inherent ordering from past to present.\n\n-   a `key`, as a set of variables that define observational units over time.\n\n-   uniquely identified observations by an index and a key.\n\nTo convert the original dis1 dataset to a `tsibble` object, we use the `as_tsibble` function and specify the `index`, i.e. the variable specifying the time unit of interest. In our case, this is `year` and `week` variables. Variables that are not used for index or key purposes, such as the `cases` variables, are considered as measured variables.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndis1z <-\n    dis1 %>%\n    mutate(date_index = make_yearweek(year = year, week = week)) %>%\n    as_tsibble(index = date_index)\n\nstr(dis1z)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntbl_ts [431 × 4] (S3: tbl_ts/tbl_df/tbl/data.frame)\n $ year      : num [1:431] 1981 1981 1981 1981 1981 ...\n $ week      : num [1:431] 1 2 3 4 5 6 7 8 9 10 ...\n $ cases     : num [1:431] 1 3 NA 4 3 2 3 4 1 NA ...\n $ date_index: week [1:431] 1981 W01, 1981 W02, 1981 W03, 1981 W04, 1981 W05, 1981 W0...\n   ..@ week_start: num 1\n - attr(*, \"key\")= tibble [1 × 1] (S3: tbl_df/tbl/data.frame)\n  ..$ .rows: list<int> [1:1] \n  .. ..$ : int [1:431] 1 2 3 4 5 6 7 8 9 10 ...\n  .. ..@ ptype: int(0) \n - attr(*, \"index\")= chr \"date_index\"\n  ..- attr(*, \"ordered\")= logi TRUE\n - attr(*, \"index2\")= chr \"date_index\"\n - attr(*, \"interval\")= interval [1:1] 1W\n  ..@ .regular: logi TRUE\n```\n\n\n:::\n\n```{.r .cell-code}\nhead(dis1z, 10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tsibble: 10 x 4 [1W]\n    year  week cases date_index\n   <dbl> <dbl> <dbl>     <week>\n 1  1981     1     1   1981 W01\n 2  1981     2     3   1981 W02\n 3  1981     3    NA   1981 W03\n 4  1981     4     4   1981 W04\n 5  1981     5     3   1981 W05\n 6  1981     6     2   1981 W06\n 7  1981     7     3   1981 W07\n 8  1981     8     4   1981 W08\n 9  1981     9     1   1981 W09\n10  1981    10    NA   1981 W10\n```\n\n\n:::\n:::\n\n\nYou can see how the number of disease 1 cases is distributed in time using the `ggplot` package.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = dis1z) +\n    geom_line(mapping = aes(x = date_index, y = cases)) +\n    scale_x_yearweek(date_labels = \"%Y\") +\n    labs(x = \"Date\", y = \"Number of Cases\", title = \"Disease 1 data\") +\n    theme_bw() + \n        theme(\n            plot.title = element_text(face = \"bold\", \n                                      size = 12),\n            legend.background = element_rect(fill = \"white\", \n                                             size = 4, \n                                             colour = \"white\"),\n            # legend.justification = c(0, 1),\n            legend.position = \"bottom\",\n            panel.grid.minor = element_blank()\n        )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: The `size` argument of `element_rect()` is deprecated as of ggplot2 3.4.0.\nℹ Please use the `linewidth` argument instead.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](03-practical_files/figure-html/task-3-1-plot-tsibble-week-tidy-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# We can save theme modifications into a single object and then use it in new plots\ntsa_theme <- theme_bw() + \n        theme(\n            plot.title = element_text(face = \"bold\", \n                                      size = 12),\n            legend.background = element_rect(fill = \"white\", \n                                             size = 4, \n                                             colour = \"white\"),\n            # legend.justification = c(0, 1),\n            legend.position = \"bottom\",\n            panel.grid.minor = element_blank()\n        )\n```\n:::\n\n\nNote from the plot that there are missing values in the data.\n\nIf data points are collected at regular time interval, we can correct missingness by providing a default a default value or interpolating missing values from other data. The `tsibble` package has the `fill_gaps` function, which fills missing values with a pre-specified default value. It is quite common to replaces `NA`s with its previous observation for each origin in time series analysis, which is easily done using `fill` function from `tidyr` package.\n\nA quick overview of implicit missing values with `tsibble` is available on `vignette(\"implicit-na\")`.\n\nAs the focus of this training is on understanding principles of time series analysis rather than visualisation of time series, we will mainly use the `ggplot` functions for the remaining exercises.\n\nOur colleagues shared some data with us they produced with Stata. They forgot to save it as a excell or csv. Luckily for us, the function `import` is here to save the day\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndis3 <- import(here(\"data\", \"tsa_pumala.csv\"))\n```\n:::\n\n\nHere you have one variable for the year, one variable for the month and one variable with the complete date in days, but in a text (`chr` class) format.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstr(dis3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n'data.frame':\t3844 obs. of  3 variables:\n $ year    : int  1995 1995 1995 1995 1995 1995 1995 1995 1995 1995 ...\n $ month   : int  1 1 1 1 1 1 1 1 1 1 ...\n $ date_str: chr  \"02/01/1995\" \"02/01/1995\" \"03/01/1995\" \"03/01/1995\" ...\n```\n\n\n:::\n\n```{.r .cell-code}\nhead(dis3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  year month   date_str\n1 1995     1 02/01/1995\n2 1995     1 02/01/1995\n3 1995     1 03/01/1995\n4 1995     1 03/01/1995\n5 1995     1 04/01/1995\n6 1995     1 04/01/1995\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(dis3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      year          month          date_str        \n Min.   :1995   Min.   : 1.000   Length:3844       \n 1st Qu.:1998   1st Qu.: 6.000   Class :character  \n Median :2000   Median : 9.000   Mode  :character  \n Mean   :2000   Mean   : 7.907                     \n 3rd Qu.:2002   3rd Qu.:11.000                     \n Max.   :2004   Max.   :12.000                     \n```\n\n\n:::\n:::\n\n\nWith the complete date, you can generate ISO weeks, but first you need the date variable to be converted from text to something R recognises as a date. The `lubridate` package has a number of convenient functions for converting text strings to dates.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstr(dis3$date_str)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n chr [1:3844] \"02/01/1995\" \"02/01/1995\" \"03/01/1995\" \"03/01/1995\" ...\n```\n\n\n:::\n\n```{.r .cell-code}\ndis3 <- dis3 %>%\n    mutate(my_date = dmy(date_str))\n\nstr(dis3$my_date)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n Date[1:3844], format: \"1995-01-02\" \"1995-01-02\" \"1995-01-03\" \"1995-01-03\" \"1995-01-04\" ...\n```\n\n\n:::\n:::\n\n\nAs a complementary note, check the help for `strftime` to learn about different date formats in R (`?strftime`).\n\nTo convert to ISO week, we can use the `ISOweek` function from the `ISOweek` package, which creates a new variable representing the ISO week. We could then also create a new variable representing the first Monday of each ISO week. Although the popular `lubridate` package has an `isoweek` function (there is also a similar function in the `surveillance` package), we use the `ISOweek` package here as it has the `ISOweek2date` function. If epidemiological weeks are required, use the `EpiWeek` package.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndis3 <- dis3 %>%\n    mutate(\n        date_isowk = ISOweek(my_date),\n        isodate = ISOweek2date(paste(date_isowk, \"-1\", sep = \"\"))\n    )\n\nhead(dis3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  year month   date_str    my_date date_isowk    isodate\n1 1995     1 02/01/1995 1995-01-02   1995-W01 1995-01-02\n2 1995     1 02/01/1995 1995-01-02   1995-W01 1995-01-02\n3 1995     1 03/01/1995 1995-01-03   1995-W01 1995-01-02\n4 1995     1 03/01/1995 1995-01-03   1995-W01 1995-01-02\n5 1995     1 04/01/1995 1995-01-04   1995-W01 1995-01-02\n6 1995     1 04/01/1995 1995-01-04   1995-W01 1995-01-02\n```\n\n\n:::\n:::\n\n\nThe `paste` command concatenates text.\n\nHere we are adding `\"-01\"` onto the end of the ISO week variable (which is formatted something like `\"1995-W01\"`), to indicate that we want the first day of that week, and then supplying that to the `ISOweek2date` function, which converts that to a date.\n\nHave a look at the new variables that have been created. `date_isowk` is the ISO week variable, in string format, and `isodate` is the Monday of each ISO week. Note that the years 1998 and 2004 each have an ISO week 53.\n\nYou have several observations in the same week since you have data from different days and one value corresponds to one case. Use the `count` function to aggregate the data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndis3_v2 <- dis3 %>%\n    count(date_isowk)\n\nhead(dis3_v2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  date_isowk  n\n1   1995-W01 13\n2   1995-W02 15\n3   1995-W03  6\n4   1995-W04  5\n5   1995-W05 11\n6   1995-W06 10\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndis3z <- dis3_v2 %>%\n    mutate(date_index = yearweek(x = date_isowk, week_start = 1L)) %>%\n    as_tsibble(index = date_index)\n\nstr(dis3z)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntbl_ts [491 × 3] (S3: tbl_ts/tbl_df/tbl/data.frame)\n $ date_isowk: chr [1:491] \"1995-W01\" \"1995-W02\" \"1995-W03\" \"1995-W04\" ...\n $ n         : int [1:491] 13 15 6 5 11 10 7 6 3 1 ...\n $ date_index: week [1:491] 1995 W01, 1995 W02, 1995 W03, 1995 W04, 1995 W05, 1995 W0...\n   ..@ week_start: int 1\n - attr(*, \"key\")= tibble [1 × 1] (S3: tbl_df/tbl/data.frame)\n  ..$ .rows: list<int> [1:1] \n  .. ..$ : int [1:491] 1 2 3 4 5 6 7 8 9 10 ...\n  .. ..@ ptype: int(0) \n - attr(*, \"index\")= chr \"date_index\"\n  ..- attr(*, \"ordered\")= logi TRUE\n - attr(*, \"index2\")= chr \"date_index\"\n - attr(*, \"interval\")= interval [1:1] 1W\n  ..@ .regular: logi TRUE\n```\n\n\n:::\n\n```{.r .cell-code}\nhead(dis3z, 10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tsibble: 10 x 3 [1W]\n   date_isowk     n date_index\n   <chr>      <int>     <week>\n 1 1995-W01      13   1995 W01\n 2 1995-W02      15   1995 W02\n 3 1995-W03       6   1995 W03\n 4 1995-W04       5   1995 W04\n 5 1995-W05      11   1995 W05\n 6 1995-W06      10   1995 W06\n 7 1995-W07       7   1995 W07\n 8 1995-W08       6   1995 W08\n 9 1995-W09       3   1995 W09\n10 1995-W10       1   1995 W10\n```\n\n\n:::\n\n```{.r .cell-code}\nggplot(data = dis3z) +\n    geom_line(mapping = aes(x = date_index, y = n)) +\n    scale_x_yearweek(date_labels = \"%Y\") +\n    labs(x = \"Date\", y = \"Number of Cases\", title = \"Disease 1 data\") +\n    tsa_theme\n```\n\n::: {.cell-output-display}\n![](03-practical_files/figure-html/task-3-1-dis3-isoweek-plot-tidy-1.png){width=672}\n:::\n:::\n\n\nAggregating cases by month is another possibility.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndis3_agg <- dis3 %>%\n    count(year, month)\n\ndis3z_v2 <- dis3_agg %>%\n    mutate(date_index = make_yearmonth(year = year, month = month)) %>%\n    as_tsibble(index = date_index)\n\nggplot(data = dis3z_v2) +\n    geom_line(mapping = aes(x = date_index, y = n)) +\n    scale_x_yearweek(date_labels = \"%Y\") +\n    labs(x = \"Date\", y = \"Number of Cases\", title = \"Disease 1 data\") +\n    tsa_theme\n```\n\n::: {.cell-output-display}\n![](03-practical_files/figure-html/task-3-1-dis3-month-plot-tidy-1.png){width=672}\n:::\n:::\n\n\n## Help for Optional Task 3.1.1 {#solution-3-1-1 .unnumbered}\n\nImport your data to R from these Excel files.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndis2 <- import(here(\"data\", \"tsa_practice.xlsx\"), which = \"dis2\")\n```\n:::\n\n\nInspect the data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstr(dis2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n'data.frame':\t44 obs. of  13 variables:\n $ year: num  1928 1929 1930 1931 1932 ...\n $ Jan : num  609 288 316 750 146 ...\n $ Feb : num  1516 241 781 2010 270 ...\n $ Mar : num  4952 347 1870 4858 621 ...\n $ Apr : num  7466 378 5309 6172 1096 ...\n $ May : num  11155 498 7499 7095 2271 ...\n $ Jun : num  7002 324 5386 4238 2537 ...\n $ Jul : num  1315 151 1386 907 1081 ...\n $ Aug : num  189 69 211 165 288 139 95 358 213 247 ...\n $ Sep : num  74 44 107 43 118 50 47 67 87 84 ...\n $ Oct : num  119 42 128 54 149 55 45 136 99 90 ...\n $ Nov : num  287 34 219 93 594 71 86 333 154 136 ...\n $ Dec : num  324 121 423 134 1183 ...\n```\n\n\n:::\n\n```{.r .cell-code}\nhead(dis2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  year  Jan  Feb  Mar  Apr   May  Jun  Jul Aug Sep Oct Nov  Dec\n1 1928  609 1516 4952 7466 11155 7002 1315 189  74 119 287  324\n2 1929  288  241  347  378   498  324  151  69  44  42  34  121\n3 1930  316  781 1870 5309  7499 5386 1386 211 107 128 219  423\n4 1931  750 2010 4858 6172  7095 4238  907 165  43  54  93  134\n5 1932  146  270  621 1096  2271 2537 1081 288 118 149 594 1183\n6 1933 1960 4699 9635 9573  6605 2697  601 139  50  55  71  131\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(dis2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      year           Jan              Feb               Mar         \n Min.   :1928   Min.   :  39.0   Min.   :   52.0   Min.   :   57.0  \n 1st Qu.:1939   1st Qu.: 195.2   1st Qu.:  256.5   1st Qu.:  416.8  \n Median :1950   Median : 302.0   Median :  692.0   Median : 1190.0  \n Mean   :1950   Mean   : 903.8   Mean   : 1750.2   Mean   : 3357.4  \n 3rd Qu.:1960   3rd Qu.:1478.2   3rd Qu.: 2083.2   3rd Qu.: 5188.8  \n Max.   :1971   Max.   :6336.0   Max.   :13226.0   Max.   :25826.0  \n      Apr               May               Jun              Jul        \n Min.   :   78.0   Min.   :   83.0   Min.   :  79.0   Min.   :  35.0  \n 1st Qu.:  622.2   1st Qu.:  700.8   1st Qu.: 724.2   1st Qu.: 340.0  \n Median : 1577.0   Median : 2110.0   Median :1809.5   Median : 598.5  \n Mean   : 3891.2   Mean   : 3379.6   Mean   :2246.2   Mean   : 713.5  \n 3rd Qu.: 6605.2   3rd Qu.: 5809.0   3rd Qu.:3153.5   3rd Qu.:1027.8  \n Max.   :22741.0   Max.   :11155.0   Max.   :7002.0   Max.   :1975.0  \n      Aug              Sep              Oct             Nov        \n Min.   : 28.00   Min.   : 18.00   Min.   : 11.0   Min.   :  12.0  \n 1st Qu.: 98.75   1st Qu.: 43.75   1st Qu.: 53.5   1st Qu.:  56.5  \n Median :187.00   Median : 70.50   Median : 82.5   Median : 112.5  \n Mean   :189.75   Mean   : 79.73   Mean   :100.5   Mean   : 193.0  \n 3rd Qu.:245.50   3rd Qu.:107.50   3rd Qu.:124.2   3rd Qu.: 236.0  \n Max.   :453.00   Max.   :184.00   Max.   :354.0   Max.   :1050.0  \n      Dec        \n Min.   :  21.0  \n 1st Qu.: 101.8  \n Median : 160.0  \n Mean   : 447.9  \n 3rd Qu.: 572.5  \n Max.   :2996.0  \n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nView(dis2)\n```\n:::\n\n\nYou have separate columns containing the counts. To plot this data, you need to first reshape your dataset by converting it from the current wide format to a long format.\n\nThe function `pivot_longer` can perform such transformation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndis2l <- dis2 %>%\n  pivot_longer(\n      cols = -year, \n      names_to = \"month\", \n      values_to = \"case\"\n  ) %>%\n  mutate(month = as_factor(month)) %>%  # as_factor sets levels in the order they appear\n  arrange(year, month)\n\nstr(dis2l)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntibble [528 × 3] (S3: tbl_df/tbl/data.frame)\n $ year : num [1:528] 1928 1928 1928 1928 1928 ...\n $ month: Factor w/ 12 levels \"Jan\",\"Feb\",\"Mar\",..: 1 2 3 4 5 6 7 8 9 10 ...\n $ case : num [1:528] 609 1516 4952 7466 11155 ...\n```\n\n\n:::\n\n```{.r .cell-code}\nhead(dis2l)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 3\n   year month  case\n  <dbl> <fct> <dbl>\n1  1928 Jan     609\n2  1928 Feb    1516\n3  1928 Mar    4952\n4  1928 Apr    7466\n5  1928 May   11155\n6  1928 Jun    7002\n```\n\n\n:::\n\n```{.r .cell-code}\ndis2l_agg <- dis2l %>%\n    mutate(date_index = make_yearmonth(year = year, month = month)) %>%\n    as_tsibble(index = date_index)\n\nhead(dis2l_agg)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tsibble: 6 x 4 [1M]\n   year month  case date_index\n  <dbl> <fct> <dbl>      <mth>\n1  1928 Jan     609  1928 ene.\n2  1928 Feb    1516  1928 feb.\n3  1928 Mar    4952  1928 mar.\n4  1928 Apr    7466  1928 abr.\n5  1928 May   11155  1928 may.\n6  1928 Jun    7002  1928 jun.\n```\n\n\n:::\n\n```{.r .cell-code}\nggplot(data = dis2l_agg) +\n    geom_line(mapping = aes(x = date_index, y = case)) +\n    scale_x_yearweek(date_labels = \"%Y\") +\n    labs(x = \"Date\", y = \"Number of Cases\", title = \"Disease 3 data\") +\n    tsa_theme\n```\n\n::: {.cell-output-display}\n![](03-practical_files/figure-html/task-3-1-opt-dis2-pivot-longer-tidy-1.png){width=672}\n:::\n:::\n\n\n**dis1** corresponds to salmonellosis cases, **dis2** to measles cases in New York.\n",
    "supporting": [
      "03-practical_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}