{
  "hash": "43c5d4a5b86f7ef641dcb06473acc14f",
  "result": {
    "engine": "knitr",
    "markdown": "# Practical Session 10: Assessing the impact of interventions using surveillance data {.unnumbered}\n\n\n\n## Expected learning outcomes {#learn-10 .unnumbered}\n\nBy the end of the case study, participants will be able to:\n\n-   Assess and interpret the effect of an intervention on trends and periodicity in surveillance data\n\n## Description of the dataset\n\nRotavirus is a very common and potentially serious infection of the large bowel, mainly affecting young babies. Nearly every child will have at least one episode of rotavirus gastroenteritis by five years of age. People of any age can be affected, but the illness is more severe in young infants. The rotavirus immunisation programme was introduced in the UK on 1 July 2013 (week 27) with the objective of preventing a significant number of young infants from developing rotavirus infection. It may also provide some additional protection to the wider population through herd immunity. The aim of the rotavirus immunisation programme is to provide two doses of vaccine to infants from six weeks of age and before 24 weeks of age. The first dose of vaccine is offered at approximately eight weeks of age and the second dose at least four weeks after the first dose.\n\nHigh coverage was rapidly achieved for the first cohort of children offered rotavirus vaccine routinely in England and this has been maintained throughout the first fourteen months of the routine programme. Over this period, rotavirus vaccine coverage for children in the routine cohort averaged 93.3% for one dose and 88.3% for two doses.[More info online on the programme.](https://assets.publishing.service.gov.uk/media/5c3def9ce5274a70ca3c3d09/RotavirusGatewayFinalVersion.pdf)\n\n\n\n## Task 10.1 {#task-10-1 .unnumbered}\n\nYou have been given a dataset for notified Rotavirus infections in England and Wales from week 23/2009 up to week 42/2018 (`rotavirus.csv`).\n\nAssess the impact of the introduction of the vaccination scheme in England and Wales for the whole population. Has the vaccine introduction had an effect on trend or periodicity patterns? Has the vaccine introduction affected the timing of the yearly outbreaks?\n\n## Task 10.2 (Optional) {#task-10-2 .unnumbered}\n\nDiscuss with colleagues how you can determine the number of cases prevented as a result of the introduction of the vaccine (Hint: refer to Practical 7!).\n\n## Help for Task 10.1 {#solution-10-1 .unnumbered}\n\nOpen the **rotavirus** dataset, which is a line list of all notified rotavirus infections in the UK between June 2009 and December 2014. Prepare your data and test if the introduction of the vaccine has had an impact on the notified number of cases of rotavirus infections in the UK. Has the trend changed? Has the periodicity changed?\n\nPrepare the **rotavirus.csv** for time-series analysis. You need to manipulate the dataset before being able to use it for time series analysis.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrota <- import(here(\"data\", \"rotavirus.csv\")) \nview(rota)\n```\n:::\n\n\nAs the data in `rota` shows above, this dataset is structured in a \"wide\" format. You can see two variables representing dates, and all other variables containing case counts are organised horizontally. Alternatively, we can store the same information by converting the first dataset to a \"long\" format, where one variable contains the different age group categories of cases (`cases_cat`), and another displays the corresponding case counts (`n`) for each age group and year-week.\n\nIn order to use ggplot2, remember that the data should be organised in a long format.\n\nThe function `as_tsibble()` is what indicates to R that the data is a time series. **index** represents the time variable and **key** represents the outcome studied.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## convert to long format\nrota_lg <- rota %>% \n    pivot_longer(\n      cols = -c(year, week),\n      names_to = \"cases_cat\",\n      values_to = \"n\"\n    )\n\n## recode\nrota_lg <- rota_lg %>%\n  mutate(cases_cat = case_when(\n    cases_cat == \"case1\" ~ \"Cases <1 year\",\n    cases_cat == \"case2\" ~ \"Cases 1 to 4 years\",\n    cases_cat == \"case3\" ~ \"Cases 5 to 14 years\",\n    cases_cat == \"case4\" ~ \"Cases 15 to 64 years\",\n    cases_cat == \"case5\" ~ \"Cases 65+ years\",\n    cases_cat == \"cases\" ~ \"Total cases\",\n    TRUE ~ NA_character_\n    ))\n\n## turn into ts format\nrota_lg <- rota_lg %>%\n  mutate(year_week = make_yearweek(year = year, week = week)) %>%\n  group_by(cases_cat) %>%\n  mutate(index = seq.int(from = 1, to = length(unique(year_week)))) %>%\n  ungroup() %>%\n  as_tsibble(index = year_week, key = cases_cat)\n```\n:::\n\n\nPlot the total number of cases by age group against time. Have a look at how rotavirus infections might differ by age groups.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = rota_lg) +\n  geom_point(mapping = aes(x = year_week, y = n), alpha = 0.3) +\n  facet_wrap(facets = vars(cases_cat), \n             scales = \"free_y\") +   \n  scale_y_continuous(limits = c(0, NA)) +\n  scale_x_yearweek(date_labels = \"%Y-%W\", \n                   date_breaks = \"52 weeks\") +\n  labs(\n    x = \"Year\", \n    y = \"Weekly case counts\",\n    title = \"Rotavirus cases\\n(note differing y scales)\"\n  ) +\n  tsa_theme\n```\n\n::: {.cell-output-display}\n![](10-practical_files/figure-html/task-10-1-rota-plot-tidy-1.png){width=100%}\n:::\n\n```{.r .cell-code}\n## Notes: \n# You can get line breaks in labels using \\n\n# You can also make all y-axes the same by using scales = \"fixed_y\"\n```\n:::\n\n\nWe want to see whether the number of cases changed after the introduction of the vaccine.\n\nFor that, first we need to state in the dataset when the vaccine was available. We are adding one new `vaccine` variable to the `rota_ts` time series. It will be 0 for weeks before week 27 2013, and 1 thereafter.\n\nWe have also created sine and cosine variables so that we can model annual seasonality as before.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrota_ts <- rota_lg %>%\n  mutate(\n    vaccine = case_when(\n      year >= 2014 ~ 1,\n      year <= 2012 ~ 0,\n      year == 2013 & week >= 27 ~ 1,\n      year == 2013 & week < 27 ~ 0,\n      TRUE ~ NA_real_\n      ),\n    sin52 = sin(2 * pi * index / 52),\n    cos52 = cos(2 * pi * index / 52)\n  )\n\n## subset to total cases\nrota_ts <- rota_ts %>% \n  filter(cases_cat == \"Total cases\")\n```\n:::\n\n\nRun first a separate model for the time before and after the introduction of the vaccine in England and Wales for all population. Can you detect any change in trend?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrotamodel_prevacc_p <- glm(n ~ index,\n    data = rota_ts %>% filter(vaccine == 0),\n    family = \"poisson\"\n) \n\n#If the `summary` command is used for a `glm` Poisson model, the log rate ratios are reported by \n#default. They need to be exponentiated \n\nsummary_rotamodel_prevacc_p <- rotamodel_prevacc_p %>% \n  gtsummary::tbl_regression(\n    exponentiate = TRUE,\n    pvalue_fun = ~style_pvalue(.x, digits = 3), \n    estimate_fun = ~style_number(.x, digits = 4)\n    ) %>%\n  gtsummary::add_glance_table(include = c(AIC, deviance, df.residual)) %>% \n  gtsummary::modify_caption(\"Rotavirus model pre-vaccination - Poisson\")\n  \nsummary_rotamodel_prevacc_p\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"hfowxijgpg\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#hfowxijgpg table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#hfowxijgpg thead, #hfowxijgpg tbody, #hfowxijgpg tfoot, #hfowxijgpg tr, #hfowxijgpg td, #hfowxijgpg th {\n  border-style: none;\n}\n\n#hfowxijgpg p {\n  margin: 0;\n  padding: 0;\n}\n\n#hfowxijgpg .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#hfowxijgpg .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#hfowxijgpg .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#hfowxijgpg .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#hfowxijgpg .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hfowxijgpg .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hfowxijgpg .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hfowxijgpg .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#hfowxijgpg .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#hfowxijgpg .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#hfowxijgpg .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#hfowxijgpg .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#hfowxijgpg .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#hfowxijgpg .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#hfowxijgpg .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#hfowxijgpg .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#hfowxijgpg .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#hfowxijgpg .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#hfowxijgpg .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hfowxijgpg .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#hfowxijgpg .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#hfowxijgpg .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#hfowxijgpg .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hfowxijgpg .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#hfowxijgpg .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#hfowxijgpg .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hfowxijgpg .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hfowxijgpg .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#hfowxijgpg .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hfowxijgpg .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#hfowxijgpg .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hfowxijgpg .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hfowxijgpg .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hfowxijgpg .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hfowxijgpg .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hfowxijgpg .gt_left {\n  text-align: left;\n}\n\n#hfowxijgpg .gt_center {\n  text-align: center;\n}\n\n#hfowxijgpg .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#hfowxijgpg .gt_font_normal {\n  font-weight: normal;\n}\n\n#hfowxijgpg .gt_font_bold {\n  font-weight: bold;\n}\n\n#hfowxijgpg .gt_font_italic {\n  font-style: italic;\n}\n\n#hfowxijgpg .gt_super {\n  font-size: 65%;\n}\n\n#hfowxijgpg .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#hfowxijgpg .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#hfowxijgpg .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#hfowxijgpg .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#hfowxijgpg .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#hfowxijgpg .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#hfowxijgpg .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#hfowxijgpg .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#hfowxijgpg div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <caption><span data-qmd-base64=\"Um90YXZpcnVzIG1vZGVsIHByZS12YWNjaW5hdGlvbiAtIFBvaXNzb24=\"><span class='gt_from_md'>Rotavirus model pre-vaccination - Poisson</span></span></caption>\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"label\"><span data-qmd-base64=\"KipDaGFyYWN0ZXJpc3RpYyoq\"><span class='gt_from_md'><strong>Characteristic</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate\"><span data-qmd-base64=\"KipJUlIqKg==\"><span class='gt_from_md'><strong>IRR</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.low\"><span data-qmd-base64=\"Kio5NSUgQ0kqKg==\"><span class='gt_from_md'><strong>95% CI</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\"><span data-qmd-base64=\"KipwLXZhbHVlKio=\"><span class='gt_from_md'><strong>p-value</strong></span></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">index</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">1.0028</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">1.0027, 1.0029</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\">AIC</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\">78,347</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\"><br /></td>\n<td headers=\"p.value\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Deviance</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">76,884</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Residual df</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">210</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><br /></td></tr>\n  </tbody>\n  <tfoot>\n    <tr class=\"gt_sourcenotes\">\n      <td class=\"gt_sourcenote\" colspan=\"4\"><span data-qmd-base64=\"QWJicmV2aWF0aW9uczogQ0kgPSBDb25maWRlbmNlIEludGVydmFsLCBJUlIgPSBJbmNpZGVuY2UgUmF0ZSBSYXRpbw==\"><span class='gt_from_md'>Abbreviations: CI = Confidence Interval, IRR = Incidence Rate Ratio</span></span></td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n**Let's reflect for a moment : Is a Poisson model the best option?**\n\nBefore we have a look at the period post-vaccination, is a Poisson model really the best model to use here? We need to check whether our data exhibit **overdispersion**.\n\nOverdispersion occurs when the mean of the data is not equal to its variance, violating the fundamental assumption of the Poisson distribution. If this happens, the model underestimates the standard error of the coefficients, biasing results towards narrower confidence intervals and artifically lower p-values.\n\nLet's check for overdispersion. We can calculate an overdispersion parameter from a model as the ratio of the deviance and the residuals degrees of freedom. Also, proper statistical test are available, for example using the `AER` library and the `dispersiontest` function.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Quick check for overdispersion: if check > 1 then use negative binomial\ndeviance <- summary(rotamodel_prevacc_p)$deviance\nresidual.df <- summary(rotamodel_prevacc_p)$df.residual\n\ncheck <- deviance / residual.df\ncheck\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 366.1138\n```\n\n\n:::\n\n```{.r .cell-code}\n# Proper check for overdispersion: \nAER::dispersiontest(rotamodel_prevacc_p, trafo = NULL, alternative = c(\"greater\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tOverdispersion test\n\ndata:  rotamodel_prevacc_p\nz = 7.2434, p-value = 2.188e-13\nalternative hypothesis: true dispersion is greater than 1\nsample estimates:\ndispersion \n   446.172 \n```\n\n\n:::\n:::\n\n\nThe overdispersion parameter is fairly greater that 1, and the overdispersion test is significant, so we can safely conclude that a negative binomial model is more appropiate. Let's compute it with the `glm.nb` function, and compare with the previous one\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#so best to use a negative binomial here\nrotamodel_prevacc_nb <- glm.nb(n ~ index,\n                               data = rota_ts %>% filter(vaccine == 0)) \n\n\n# Table with results\nsummary_rotamodel_prevacc_nb <- rotamodel_prevacc_nb %>%\n  gtsummary::tbl_regression(\n    exponentiate = TRUE,\n    pvalue_fun = ~style_pvalue(.x, digits = 3),\n    estimate_fun = ~style_number(.x, digits = 4)\n    ) %>%\n  gtsummary::add_glance_table(include = c(AIC, deviance, df.residual)) %>% \n  gtsummary::modify_caption(\"Rotavirus model pre-vaccination - Negative Binomial\")\n  \n\n# Let's compare the two models\ncomparison_p_nb <- gtsummary::tbl_merge(\n  tbls = list(summary_rotamodel_prevacc_p, \n              summary_rotamodel_prevacc_nb),\n  tab_spanner = c(\"Poisson model\", \"Negative Binomial model\")\n  )\n\ncomparison_p_nb\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"oyuzxvmaso\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#oyuzxvmaso table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#oyuzxvmaso thead, #oyuzxvmaso tbody, #oyuzxvmaso tfoot, #oyuzxvmaso tr, #oyuzxvmaso td, #oyuzxvmaso th {\n  border-style: none;\n}\n\n#oyuzxvmaso p {\n  margin: 0;\n  padding: 0;\n}\n\n#oyuzxvmaso .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#oyuzxvmaso .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#oyuzxvmaso .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#oyuzxvmaso .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#oyuzxvmaso .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#oyuzxvmaso .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#oyuzxvmaso .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#oyuzxvmaso .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#oyuzxvmaso .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#oyuzxvmaso .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#oyuzxvmaso .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#oyuzxvmaso .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#oyuzxvmaso .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#oyuzxvmaso .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#oyuzxvmaso .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#oyuzxvmaso .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#oyuzxvmaso .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#oyuzxvmaso .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#oyuzxvmaso .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oyuzxvmaso .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#oyuzxvmaso .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#oyuzxvmaso .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#oyuzxvmaso .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oyuzxvmaso .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#oyuzxvmaso .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#oyuzxvmaso .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#oyuzxvmaso .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oyuzxvmaso .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#oyuzxvmaso .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#oyuzxvmaso .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#oyuzxvmaso .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#oyuzxvmaso .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#oyuzxvmaso .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oyuzxvmaso .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#oyuzxvmaso .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oyuzxvmaso .gt_left {\n  text-align: left;\n}\n\n#oyuzxvmaso .gt_center {\n  text-align: center;\n}\n\n#oyuzxvmaso .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#oyuzxvmaso .gt_font_normal {\n  font-weight: normal;\n}\n\n#oyuzxvmaso .gt_font_bold {\n  font-weight: bold;\n}\n\n#oyuzxvmaso .gt_font_italic {\n  font-style: italic;\n}\n\n#oyuzxvmaso .gt_super {\n  font-size: 65%;\n}\n\n#oyuzxvmaso .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#oyuzxvmaso .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#oyuzxvmaso .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#oyuzxvmaso .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#oyuzxvmaso .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#oyuzxvmaso .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#oyuzxvmaso .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#oyuzxvmaso .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#oyuzxvmaso div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <caption><span data-qmd-base64=\"Um90YXZpcnVzIG1vZGVsIHByZS12YWNjaW5hdGlvbiAtIFBvaXNzb24=\"><span class='gt_from_md'>Rotavirus model pre-vaccination - Poisson</span></span></caption>\n  <thead>\n    <tr class=\"gt_col_headings gt_spanner_row\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"label\"><span data-qmd-base64=\"KipDaGFyYWN0ZXJpc3RpYyoq\"><span class='gt_from_md'><strong>Characteristic</strong></span></span></th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"3\" scope=\"colgroup\" id=\"level 1; estimate_1\">\n        <div class=\"gt_column_spanner\"><span data-qmd-base64=\"UG9pc3NvbiBtb2RlbA==\"><span class='gt_from_md'>Poisson model</span></span></div>\n      </th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"3\" scope=\"colgroup\" id=\"level 1; estimate_2\">\n        <div class=\"gt_column_spanner\"><span data-qmd-base64=\"TmVnYXRpdmUgQmlub21pYWwgbW9kZWw=\"><span class='gt_from_md'>Negative Binomial model</span></span></div>\n      </th>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate_1\"><span data-qmd-base64=\"KipJUlIqKg==\"><span class='gt_from_md'><strong>IRR</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.low_1\"><span data-qmd-base64=\"Kio5NSUgQ0kqKg==\"><span class='gt_from_md'><strong>95% CI</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value_1\"><span data-qmd-base64=\"KipwLXZhbHVlKio=\"><span class='gt_from_md'><strong>p-value</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate_2\"><span data-qmd-base64=\"KipJUlIqKg==\"><span class='gt_from_md'><strong>IRR</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.low_2\"><span data-qmd-base64=\"Kio5NSUgQ0kqKg==\"><span class='gt_from_md'><strong>95% CI</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value_2\"><span data-qmd-base64=\"KipwLXZhbHVlKio=\"><span class='gt_from_md'><strong>p-value</strong></span></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">index</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\">1.0028</td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\">1.0027, 1.0029</td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\"><0.001</td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\">1.0029</td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\">1.0005, 1.0054</td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\">0.015</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\">AIC</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\">78,347</td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\"><br /></td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\"><br /></td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\">2,854</td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\"><br /></td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Deviance</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\">76,884</td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\">248</td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Residual df</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\">210</td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\">210</td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\"><br /></td></tr>\n  </tbody>\n  <tfoot>\n    <tr class=\"gt_sourcenotes\">\n      <td class=\"gt_sourcenote\" colspan=\"7\"><span data-qmd-base64=\"QWJicmV2aWF0aW9uczogQ0kgPSBDb25maWRlbmNlIEludGVydmFsLCBJUlIgPSBJbmNpZGVuY2UgUmF0ZSBSYXRpbw==\"><span class='gt_from_md'>Abbreviations: CI = Confidence Interval, IRR = Incidence Rate Ratio</span></span></td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\nThe AIC comparison proves how the negative binomial model outperforms the Poisson model. Also, realize the confidence interval around the trend for the Poisson model is narrower than for the negative binomial model.\n\nLet's use negative binomial models for the rest of the practical.\n\n**Now let's look at the period post-introduction of the vaccine.**\n\nWe will fit a model for the post-vaccination period and compare it with the pre-vaccination period\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrotamodel_postvacc <- glm.nb(n ~ index,\n                             data = rota_ts %>% filter(vaccine == 1))\n\n# Table with results \nsummary_rotamodel_postvacc <- rotamodel_postvacc %>% \n  gtsummary::tbl_regression(\n    exponentiate = TRUE,\n    pvalue_fun = ~style_pvalue(.x, digits = 3),\n    estimate_fun = ~style_number(.x, digits = 4)) %>%\n  gtsummary::add_glance_table(include = c(AIC, deviance, df.residual)) %>% \n  gtsummary::modify_caption(\"Rotavirus model post-vaccination\")\n\n\n# Comparisson between models\ncomparison_pre_post <- gtsummary::tbl_merge(\n    tbls = list(summary_rotamodel_prevacc_nb, \n                summary_rotamodel_postvacc),\n    tab_spanner = c(\"Pre-vaccination\", \"Post-vaccination\")\n  )\n\ncomparison_pre_post\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"blsnvgzmki\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#blsnvgzmki table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#blsnvgzmki thead, #blsnvgzmki tbody, #blsnvgzmki tfoot, #blsnvgzmki tr, #blsnvgzmki td, #blsnvgzmki th {\n  border-style: none;\n}\n\n#blsnvgzmki p {\n  margin: 0;\n  padding: 0;\n}\n\n#blsnvgzmki .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#blsnvgzmki .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#blsnvgzmki .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#blsnvgzmki .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#blsnvgzmki .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#blsnvgzmki .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#blsnvgzmki .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#blsnvgzmki .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#blsnvgzmki .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#blsnvgzmki .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#blsnvgzmki .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#blsnvgzmki .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#blsnvgzmki .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#blsnvgzmki .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#blsnvgzmki .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#blsnvgzmki .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#blsnvgzmki .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#blsnvgzmki .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#blsnvgzmki .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#blsnvgzmki .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#blsnvgzmki .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#blsnvgzmki .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#blsnvgzmki .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#blsnvgzmki .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#blsnvgzmki .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#blsnvgzmki .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#blsnvgzmki .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#blsnvgzmki .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#blsnvgzmki .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#blsnvgzmki .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#blsnvgzmki .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#blsnvgzmki .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#blsnvgzmki .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#blsnvgzmki .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#blsnvgzmki .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#blsnvgzmki .gt_left {\n  text-align: left;\n}\n\n#blsnvgzmki .gt_center {\n  text-align: center;\n}\n\n#blsnvgzmki .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#blsnvgzmki .gt_font_normal {\n  font-weight: normal;\n}\n\n#blsnvgzmki .gt_font_bold {\n  font-weight: bold;\n}\n\n#blsnvgzmki .gt_font_italic {\n  font-style: italic;\n}\n\n#blsnvgzmki .gt_super {\n  font-size: 65%;\n}\n\n#blsnvgzmki .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#blsnvgzmki .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#blsnvgzmki .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#blsnvgzmki .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#blsnvgzmki .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#blsnvgzmki .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#blsnvgzmki .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#blsnvgzmki .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#blsnvgzmki div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <caption><span data-qmd-base64=\"Um90YXZpcnVzIG1vZGVsIHByZS12YWNjaW5hdGlvbiAtIE5lZ2F0aXZlIEJpbm9taWFs\"><span class='gt_from_md'>Rotavirus model pre-vaccination - Negative Binomial</span></span></caption>\n  <thead>\n    <tr class=\"gt_col_headings gt_spanner_row\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"label\"><span data-qmd-base64=\"KipDaGFyYWN0ZXJpc3RpYyoq\"><span class='gt_from_md'><strong>Characteristic</strong></span></span></th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"3\" scope=\"colgroup\" id=\"level 1; estimate_1\">\n        <div class=\"gt_column_spanner\"><span data-qmd-base64=\"UHJlLXZhY2NpbmF0aW9u\"><span class='gt_from_md'>Pre-vaccination</span></span></div>\n      </th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"3\" scope=\"colgroup\" id=\"level 1; estimate_2\">\n        <div class=\"gt_column_spanner\"><span data-qmd-base64=\"UG9zdC12YWNjaW5hdGlvbg==\"><span class='gt_from_md'>Post-vaccination</span></span></div>\n      </th>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate_1\"><span data-qmd-base64=\"KipJUlIqKg==\"><span class='gt_from_md'><strong>IRR</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.low_1\"><span data-qmd-base64=\"Kio5NSUgQ0kqKg==\"><span class='gt_from_md'><strong>95% CI</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value_1\"><span data-qmd-base64=\"KipwLXZhbHVlKio=\"><span class='gt_from_md'><strong>p-value</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate_2\"><span data-qmd-base64=\"KipJUlIqKg==\"><span class='gt_from_md'><strong>IRR</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.low_2\"><span data-qmd-base64=\"Kio5NSUgQ0kqKg==\"><span class='gt_from_md'><strong>95% CI</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value_2\"><span data-qmd-base64=\"KipwLXZhbHVlKio=\"><span class='gt_from_md'><strong>p-value</strong></span></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">index</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\">1.0029</td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\">1.0005, 1.0054</td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\">0.015</td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\">0.9977</td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\">0.9967, 0.9988</td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\">AIC</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\">2,854</td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\"><br /></td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\"><br /></td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\">2,830</td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\"><br /></td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Deviance</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\">248</td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\">293</td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Residual df</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\">210</td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\">274</td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\"><br /></td></tr>\n  </tbody>\n  <tfoot>\n    <tr class=\"gt_sourcenotes\">\n      <td class=\"gt_sourcenote\" colspan=\"7\"><span data-qmd-base64=\"QWJicmV2aWF0aW9uczogQ0kgPSBDb25maWRlbmNlIEludGVydmFsLCBJUlIgPSBJbmNpZGVuY2UgUmF0ZSBSYXRpbw==\"><span class='gt_from_md'>Abbreviations: CI = Confidence Interval, IRR = Incidence Rate Ratio</span></span></td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\nWe can see a difference in trends, but the two models cannot be directly compared.\n\nNow we want to run one single model for both periods (before/after the introduction of the vaccine)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrotamodel_trend <- glm.nb(n ~ index + vaccine,\n                          data = rota_ts)\n\n# Table with results\nsummary_rotamodel_trend <- rotamodel_trend %>% \n  gtsummary::tbl_regression(\n    exponentiate = TRUE,\n    pvalue_fun = ~style_pvalue(.x, digits = 3),\n    estimate_fun = ~style_number(.x, digits = 4)) %>%\n  gtsummary::add_glance_table(include = c(AIC, deviance, df.residual)) %>% \n  gtsummary::modify_caption(\"Rotavirus model with trend and vaccine intervention\")\n\nsummary_rotamodel_trend\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"lmhxoauysm\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#lmhxoauysm table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#lmhxoauysm thead, #lmhxoauysm tbody, #lmhxoauysm tfoot, #lmhxoauysm tr, #lmhxoauysm td, #lmhxoauysm th {\n  border-style: none;\n}\n\n#lmhxoauysm p {\n  margin: 0;\n  padding: 0;\n}\n\n#lmhxoauysm .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#lmhxoauysm .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#lmhxoauysm .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#lmhxoauysm .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#lmhxoauysm .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#lmhxoauysm .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lmhxoauysm .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#lmhxoauysm .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#lmhxoauysm .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#lmhxoauysm .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#lmhxoauysm .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#lmhxoauysm .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#lmhxoauysm .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#lmhxoauysm .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#lmhxoauysm .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#lmhxoauysm .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#lmhxoauysm .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#lmhxoauysm .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#lmhxoauysm .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lmhxoauysm .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#lmhxoauysm .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#lmhxoauysm .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#lmhxoauysm .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lmhxoauysm .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#lmhxoauysm .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#lmhxoauysm .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lmhxoauysm .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lmhxoauysm .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#lmhxoauysm .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lmhxoauysm .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#lmhxoauysm .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lmhxoauysm .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#lmhxoauysm .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lmhxoauysm .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#lmhxoauysm .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lmhxoauysm .gt_left {\n  text-align: left;\n}\n\n#lmhxoauysm .gt_center {\n  text-align: center;\n}\n\n#lmhxoauysm .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#lmhxoauysm .gt_font_normal {\n  font-weight: normal;\n}\n\n#lmhxoauysm .gt_font_bold {\n  font-weight: bold;\n}\n\n#lmhxoauysm .gt_font_italic {\n  font-style: italic;\n}\n\n#lmhxoauysm .gt_super {\n  font-size: 65%;\n}\n\n#lmhxoauysm .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#lmhxoauysm .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#lmhxoauysm .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#lmhxoauysm .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#lmhxoauysm .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#lmhxoauysm .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#lmhxoauysm .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#lmhxoauysm .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#lmhxoauysm div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <caption><span data-qmd-base64=\"Um90YXZpcnVzIG1vZGVsIHdpdGggdHJlbmQgYW5kIHZhY2NpbmUgaW50ZXJ2ZW50aW9u\"><span class='gt_from_md'>Rotavirus model with trend and vaccine intervention</span></span></caption>\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"label\"><span data-qmd-base64=\"KipDaGFyYWN0ZXJpc3RpYyoq\"><span class='gt_from_md'><strong>Characteristic</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate\"><span data-qmd-base64=\"KipJUlIqKg==\"><span class='gt_from_md'><strong>IRR</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.low\"><span data-qmd-base64=\"Kio5NSUgQ0kqKg==\"><span class='gt_from_md'><strong>95% CI</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\"><span data-qmd-base64=\"KipwLXZhbHVlKio=\"><span class='gt_from_md'><strong>p-value</strong></span></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">index</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.9995</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0.9983, 1.0006</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.341</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">vaccine</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.2624</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0.1940, 0.3551</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\">AIC</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\">5,768</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\"><br /></td>\n<td headers=\"p.value\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Deviance</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">544</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Residual df</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">485</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><br /></td></tr>\n  </tbody>\n  <tfoot>\n    <tr class=\"gt_sourcenotes\">\n      <td class=\"gt_sourcenote\" colspan=\"4\"><span data-qmd-base64=\"QWJicmV2aWF0aW9uczogQ0kgPSBDb25maWRlbmNlIEludGVydmFsLCBJUlIgPSBJbmNpZGVuY2UgUmF0ZSBSYXRpbw==\"><span class='gt_from_md'>Abbreviations: CI = Confidence Interval, IRR = Incidence Rate Ratio</span></span></td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\nHow would you interpret these results?\n\nWe can plot the model against the raw data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrota_ts <- rota_ts %>% \n  mutate(fitted_trend = fitted(rotamodel_trend))\n   \n\nggplot(data = rota_ts) +\n  geom_point(mapping = aes(x = year_week, y = n), alpha = 0.3) +\n  geom_line(mapping = aes(x = year_week, y = fitted_trend), \n            alpha = 0.7, colour = \"green\") +\n  scale_y_continuous(limits = c(0, NA)) +\n  scale_x_yearweek(date_labels = \"%Y-%W\", \n                   date_breaks = \"52 weeks\") +\n  labs(x = \"Year\", \n       y = \"Weekly case counts\",\n       title = \"Rotavirus cases: model with trend and intervention\"\n  ) +\n  tsa_theme\n```\n\n::: {.cell-output-display}\n![](10-practical_files/figure-html/task-10-1-rota-vacc-interv-modeltrend-plot-tidy-1.png){width=100%}\n:::\n:::\n\n\nNow we want to run one single model for both periods (before/after the introduction of the vaccine), this time including seasonality.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrotamodel_seasonality <- glm.nb(n ~ index + sin52 + cos52 + vaccine,\n                                data = rota_ts)\n\n\nsummary_rotamodel_seasonality <- rotamodel_seasonality %>% \n  gtsummary::tbl_regression(\n    exponentiate = TRUE,\n    pvalue_fun = ~style_pvalue(.x, digits = 3),\n    estimate_fun = ~style_number(.x, digits = 4)) %>%\n  gtsummary::add_glance_table(include = c(AIC, deviance, df.residual)) %>% \n  gtsummary::modify_caption(\"Rotavirus model with seasonality, trend and vaccine intervention\")\n\nsummary_rotamodel_seasonality\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"wdirbrnnyo\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#wdirbrnnyo table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#wdirbrnnyo thead, #wdirbrnnyo tbody, #wdirbrnnyo tfoot, #wdirbrnnyo tr, #wdirbrnnyo td, #wdirbrnnyo th {\n  border-style: none;\n}\n\n#wdirbrnnyo p {\n  margin: 0;\n  padding: 0;\n}\n\n#wdirbrnnyo .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#wdirbrnnyo .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#wdirbrnnyo .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#wdirbrnnyo .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#wdirbrnnyo .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#wdirbrnnyo .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wdirbrnnyo .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#wdirbrnnyo .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#wdirbrnnyo .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#wdirbrnnyo .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#wdirbrnnyo .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#wdirbrnnyo .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#wdirbrnnyo .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#wdirbrnnyo .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#wdirbrnnyo .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#wdirbrnnyo .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#wdirbrnnyo .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#wdirbrnnyo .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#wdirbrnnyo .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wdirbrnnyo .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#wdirbrnnyo .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#wdirbrnnyo .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#wdirbrnnyo .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wdirbrnnyo .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#wdirbrnnyo .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#wdirbrnnyo .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wdirbrnnyo .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wdirbrnnyo .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#wdirbrnnyo .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wdirbrnnyo .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#wdirbrnnyo .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wdirbrnnyo .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#wdirbrnnyo .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wdirbrnnyo .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#wdirbrnnyo .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wdirbrnnyo .gt_left {\n  text-align: left;\n}\n\n#wdirbrnnyo .gt_center {\n  text-align: center;\n}\n\n#wdirbrnnyo .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#wdirbrnnyo .gt_font_normal {\n  font-weight: normal;\n}\n\n#wdirbrnnyo .gt_font_bold {\n  font-weight: bold;\n}\n\n#wdirbrnnyo .gt_font_italic {\n  font-style: italic;\n}\n\n#wdirbrnnyo .gt_super {\n  font-size: 65%;\n}\n\n#wdirbrnnyo .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#wdirbrnnyo .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#wdirbrnnyo .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#wdirbrnnyo .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#wdirbrnnyo .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#wdirbrnnyo .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#wdirbrnnyo .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#wdirbrnnyo .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#wdirbrnnyo div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <caption><span data-qmd-base64=\"Um90YXZpcnVzIG1vZGVsIHdpdGggc2Vhc29uYWxpdHksIHRyZW5kIGFuZCB2YWNjaW5lIGludGVydmVudGlvbg==\"><span class='gt_from_md'>Rotavirus model with seasonality, trend and vaccine intervention</span></span></caption>\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"label\"><span data-qmd-base64=\"KipDaGFyYWN0ZXJpc3RpYyoq\"><span class='gt_from_md'><strong>Characteristic</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate\"><span data-qmd-base64=\"KipJUlIqKg==\"><span class='gt_from_md'><strong>IRR</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.low\"><span data-qmd-base64=\"Kio5NSUgQ0kqKg==\"><span class='gt_from_md'><strong>95% CI</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\"><span data-qmd-base64=\"KipwLXZhbHVlKio=\"><span class='gt_from_md'><strong>p-value</strong></span></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">index</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.9989</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0.9982, 0.9996</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">sin52</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.4245</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0.3951, 0.4560</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">cos52</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">2.0527</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">1.9092, 2.2071</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">vaccine</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.4885</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0.4034, 0.5919</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\">AIC</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\">5,225</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\"><br /></td>\n<td headers=\"p.value\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Deviance</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">506</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Residual df</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">483</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><br /></td></tr>\n  </tbody>\n  <tfoot>\n    <tr class=\"gt_sourcenotes\">\n      <td class=\"gt_sourcenote\" colspan=\"4\"><span data-qmd-base64=\"QWJicmV2aWF0aW9uczogQ0kgPSBDb25maWRlbmNlIEludGVydmFsLCBJUlIgPSBJbmNpZGVuY2UgUmF0ZSBSYXRpbw==\"><span class='gt_from_md'>Abbreviations: CI = Confidence Interval, IRR = Incidence Rate Ratio</span></span></td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\nWe can plot the model against the raw data again.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrota_ts <- rota_ts %>% \n  mutate(fitted_seasonality = fitted(rotamodel_seasonality))\n \n\nggplot(data = rota_ts) + \n  geom_point(mapping = aes(x = year_week, y = n), alpha = 0.3) +\n  geom_line(mapping = aes(x = year_week, y = fitted_seasonality), \n            alpha = 0.7, colour = \"green\") +\n  scale_y_continuous(limits = c(0, NA)) +\n  scale_x_yearweek(date_labels = \"%Y-%W\", \n                   date_breaks = \"52 weeks\") +\n  labs(x = \"Year\", \n       y = \"Weekly case counts\",\n       title = \"Rotavirus cases: model with trend, seasonality, and intervention\"\n    ) +\n  tsa_theme\n```\n\n::: {.cell-output-display}\n![](10-practical_files/figure-html/task-10-1-rota-vacc-interv-modelseason-plot-tidy-1.png){width=100%}\n:::\n:::\n\n\nTo be able to comment on any change in trend after the introduction of the vaccine, we need to either include an interaction term in the model or include a time variable that starts at the introduction of the vaccine. Let's here use an interaction term.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrotamodel_winteraction <- glm.nb(n ~ index * vaccine + sin52 + cos52,\n                                 data = rota_ts)\n\nsummary_rotamodel_trendinteraction <- rotamodel_winteraction %>% \n  gtsummary::tbl_regression(\n    exponentiate = TRUE,\n    pvalue_fun = ~style_pvalue(.x, digits = 3),\n    estimate_fun = ~style_number(.x, digits = 4)) %>%\n  gtsummary::add_glance_table(include = c(AIC, deviance, df.residual)) %>% \n  gtsummary::modify_caption(\"Rotavirus model with seasonality, trend, vaccine and interaction between intervention and trend\")\n\nsummary_rotamodel_trendinteraction\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"fzqhqtlbbe\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#fzqhqtlbbe table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#fzqhqtlbbe thead, #fzqhqtlbbe tbody, #fzqhqtlbbe tfoot, #fzqhqtlbbe tr, #fzqhqtlbbe td, #fzqhqtlbbe th {\n  border-style: none;\n}\n\n#fzqhqtlbbe p {\n  margin: 0;\n  padding: 0;\n}\n\n#fzqhqtlbbe .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#fzqhqtlbbe .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#fzqhqtlbbe .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#fzqhqtlbbe .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#fzqhqtlbbe .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#fzqhqtlbbe .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fzqhqtlbbe .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#fzqhqtlbbe .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#fzqhqtlbbe .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#fzqhqtlbbe .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#fzqhqtlbbe .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#fzqhqtlbbe .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#fzqhqtlbbe .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#fzqhqtlbbe .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#fzqhqtlbbe .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#fzqhqtlbbe .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#fzqhqtlbbe .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#fzqhqtlbbe .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#fzqhqtlbbe .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fzqhqtlbbe .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#fzqhqtlbbe .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#fzqhqtlbbe .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#fzqhqtlbbe .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fzqhqtlbbe .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#fzqhqtlbbe .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#fzqhqtlbbe .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fzqhqtlbbe .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fzqhqtlbbe .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#fzqhqtlbbe .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fzqhqtlbbe .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#fzqhqtlbbe .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fzqhqtlbbe .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#fzqhqtlbbe .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fzqhqtlbbe .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#fzqhqtlbbe .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fzqhqtlbbe .gt_left {\n  text-align: left;\n}\n\n#fzqhqtlbbe .gt_center {\n  text-align: center;\n}\n\n#fzqhqtlbbe .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#fzqhqtlbbe .gt_font_normal {\n  font-weight: normal;\n}\n\n#fzqhqtlbbe .gt_font_bold {\n  font-weight: bold;\n}\n\n#fzqhqtlbbe .gt_font_italic {\n  font-style: italic;\n}\n\n#fzqhqtlbbe .gt_super {\n  font-size: 65%;\n}\n\n#fzqhqtlbbe .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#fzqhqtlbbe .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#fzqhqtlbbe .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#fzqhqtlbbe .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#fzqhqtlbbe .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#fzqhqtlbbe .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#fzqhqtlbbe .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#fzqhqtlbbe .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#fzqhqtlbbe div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <caption><span data-qmd-base64=\"Um90YXZpcnVzIG1vZGVsIHdpdGggc2Vhc29uYWxpdHksIHRyZW5kLCB2YWNjaW5lIGFuZCBpbnRlcmFjdGlvbiBiZXR3ZWVuIGludGVydmVudGlvbiBhbmQgdHJlbmQ=\"><span class='gt_from_md'>Rotavirus model with seasonality, trend, vaccine and interaction between intervention and trend</span></span></caption>\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"label\"><span data-qmd-base64=\"KipDaGFyYWN0ZXJpc3RpYyoq\"><span class='gt_from_md'><strong>Characteristic</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate\"><span data-qmd-base64=\"KipJUlIqKg==\"><span class='gt_from_md'><strong>IRR</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.low\"><span data-qmd-base64=\"Kio5NSUgQ0kqKg==\"><span class='gt_from_md'><strong>95% CI</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\"><span data-qmd-base64=\"KipwLXZhbHVlKio=\"><span class='gt_from_md'><strong>p-value</strong></span></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">index</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">1.0015</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">1.0003, 1.0027</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.015</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">vaccine</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.9833</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0.7076, 1.3693</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.919</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">sin52</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.4290</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0.4001, 0.4600</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">cos52</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">2.0434</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">1.9036, 2.1935</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">index * vaccine</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.9962</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0.9948, 0.9977</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\">AIC</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\">5,202</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\"><br /></td>\n<td headers=\"p.value\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Deviance</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">505</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Residual df</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">482</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><br /></td></tr>\n  </tbody>\n  <tfoot>\n    <tr class=\"gt_sourcenotes\">\n      <td class=\"gt_sourcenote\" colspan=\"4\"><span data-qmd-base64=\"QWJicmV2aWF0aW9uczogQ0kgPSBDb25maWRlbmNlIEludGVydmFsLCBJUlIgPSBJbmNpZGVuY2UgUmF0ZSBSYXRpbw==\"><span class='gt_from_md'>Abbreviations: CI = Confidence Interval, IRR = Incidence Rate Ratio</span></span></td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\nYou can visualize the effect of the interaction term using `plot_model()` from the `sjPlot` library\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsjPlot::plot_model(rotamodel_winteraction, type =\"int\") \n```\n\n::: {.cell-output-display}\n![](10-practical_files/figure-html/task-10-1-rota-vacc-interv-vizinteraction-1.png){width=100%}\n:::\n:::\n\n\nHave there been any changes in seasonality, too?\n\nNote how we can use brackets to introduce interaction terms for several variables.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrotamodel_full <- glm.nb(n ~ (sin52 + cos52 + index)*vaccine,\n                         data = rota_ts)\n\n\nsummary_rotamodel_full <- rotamodel_full %>% \n  gtsummary::tbl_regression(\n    exponentiate = TRUE,\n    pvalue_fun = ~style_pvalue(.x, digits = 3),\n    estimate_fun = ~style_number(.x, digits = 4)) %>%\n  gtsummary::add_glance_table(include = c(AIC, deviance, df.residual)) %>% \n  gtsummary::modify_caption(\"Rotavirus model with seasonality, trend, vaccine and interaction term\")\n\nsummary_rotamodel_full\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"funxaqscrs\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#funxaqscrs table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#funxaqscrs thead, #funxaqscrs tbody, #funxaqscrs tfoot, #funxaqscrs tr, #funxaqscrs td, #funxaqscrs th {\n  border-style: none;\n}\n\n#funxaqscrs p {\n  margin: 0;\n  padding: 0;\n}\n\n#funxaqscrs .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#funxaqscrs .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#funxaqscrs .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#funxaqscrs .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#funxaqscrs .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#funxaqscrs .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#funxaqscrs .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#funxaqscrs .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#funxaqscrs .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#funxaqscrs .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#funxaqscrs .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#funxaqscrs .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#funxaqscrs .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#funxaqscrs .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#funxaqscrs .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#funxaqscrs .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#funxaqscrs .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#funxaqscrs .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#funxaqscrs .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#funxaqscrs .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#funxaqscrs .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#funxaqscrs .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#funxaqscrs .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#funxaqscrs .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#funxaqscrs .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#funxaqscrs .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#funxaqscrs .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#funxaqscrs .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#funxaqscrs .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#funxaqscrs .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#funxaqscrs .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#funxaqscrs .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#funxaqscrs .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#funxaqscrs .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#funxaqscrs .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#funxaqscrs .gt_left {\n  text-align: left;\n}\n\n#funxaqscrs .gt_center {\n  text-align: center;\n}\n\n#funxaqscrs .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#funxaqscrs .gt_font_normal {\n  font-weight: normal;\n}\n\n#funxaqscrs .gt_font_bold {\n  font-weight: bold;\n}\n\n#funxaqscrs .gt_font_italic {\n  font-style: italic;\n}\n\n#funxaqscrs .gt_super {\n  font-size: 65%;\n}\n\n#funxaqscrs .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#funxaqscrs .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#funxaqscrs .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#funxaqscrs .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#funxaqscrs .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#funxaqscrs .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#funxaqscrs .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#funxaqscrs .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#funxaqscrs div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <caption><span data-qmd-base64=\"Um90YXZpcnVzIG1vZGVsIHdpdGggc2Vhc29uYWxpdHksIHRyZW5kLCB2YWNjaW5lIGFuZCBpbnRlcmFjdGlvbiB0ZXJt\"><span class='gt_from_md'>Rotavirus model with seasonality, trend, vaccine and interaction term</span></span></caption>\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"label\"><span data-qmd-base64=\"KipDaGFyYWN0ZXJpc3RpYyoq\"><span class='gt_from_md'><strong>Characteristic</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate\"><span data-qmd-base64=\"KipJUlIqKg==\"><span class='gt_from_md'><strong>IRR</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.low\"><span data-qmd-base64=\"Kio5NSUgQ0kqKg==\"><span class='gt_from_md'><strong>95% CI</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\"><span data-qmd-base64=\"KipwLXZhbHVlKio=\"><span class='gt_from_md'><strong>p-value</strong></span></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">sin52</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.2551</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0.2361, 0.2756</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">cos52</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">2.1715</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">1.9979, 2.3602</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">index</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">1.0006</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0.9997, 1.0016</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.185</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">vaccine</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.9175</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0.7086, 1.1897</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.504</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">sin52 * vaccine</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">2.6312</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">2.3698, 2.9216</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">cos52 * vaccine</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.8702</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0.7800, 0.9709</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.010</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">index * vaccine</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.9971</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0.9959, 0.9982</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\">AIC</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\">4,945</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\"><br /></td>\n<td headers=\"p.value\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Deviance</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">496</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Residual df</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">480</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><br /></td></tr>\n  </tbody>\n  <tfoot>\n    <tr class=\"gt_sourcenotes\">\n      <td class=\"gt_sourcenote\" colspan=\"4\"><span data-qmd-base64=\"QWJicmV2aWF0aW9uczogQ0kgPSBDb25maWRlbmNlIEludGVydmFsLCBJUlIgPSBJbmNpZGVuY2UgUmF0ZSBSYXRpbw==\"><span class='gt_from_md'>Abbreviations: CI = Confidence Interval, IRR = Incidence Rate Ratio</span></span></td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n\n```{.r .cell-code}\nsjPlot::plot_model(rotamodel_full, type =\"int\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[[1]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](10-practical_files/figure-html/task-10-1-rota-vacc-interv-model5-1.png){width=100%}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[2]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](10-practical_files/figure-html/task-10-1-rota-vacc-interv-model5-2.png){width=100%}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[3]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](10-practical_files/figure-html/task-10-1-rota-vacc-interv-model5-3.png){width=100%}\n:::\n:::\n\n\nLet's plot the fitted full model. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nrota_ts <- rota_ts %>% \n  mutate(fitted_full = fitted(rotamodel_full))\n\n\nggplot(data = rota_ts) +\n  geom_point(mapping = aes(x = year_week, y = n), alpha = 0.3) +\n  geom_line(mapping = aes(x = year_week, y = fitted_full), \n            alpha = 0.7, colour = \"green\") +\n  scale_y_continuous(limits = c(0, NA)) +\n  scale_x_yearweek(date_labels = \"%Y-%W\", date_breaks = \"52 weeks\") +\n  labs(x = \"Year\",\n       y = \"Weekly case counts\",\n       title = \"Rotavirus cases: model with trend, seasonality, intervention \\n and interaction terms\"\n  ) +\n  tsa_theme\n```\n\n::: {.cell-output-display}\n![](10-practical_files/figure-html/task-10-1-rota-vacc-interv-model5-plot-tidy-1.png){width=100%}\n:::\n:::\n\n\nWe can now compare all models next to each other:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncomparison_all <- gtsummary::tbl_merge(\n    tbls = list(summary_rotamodel_seasonality,\n                summary_rotamodel_trendinteraction,  \n                summary_rotamodel_full),\n    tab_spanner = c(\"Model without interaction terms\", \n                    \"Interaction with trend only\", \n                    \"Full model\")\n  )\n\ncomparison_all\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"naxoqyvfky\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#naxoqyvfky table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#naxoqyvfky thead, #naxoqyvfky tbody, #naxoqyvfky tfoot, #naxoqyvfky tr, #naxoqyvfky td, #naxoqyvfky th {\n  border-style: none;\n}\n\n#naxoqyvfky p {\n  margin: 0;\n  padding: 0;\n}\n\n#naxoqyvfky .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#naxoqyvfky .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#naxoqyvfky .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#naxoqyvfky .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#naxoqyvfky .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#naxoqyvfky .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#naxoqyvfky .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#naxoqyvfky .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#naxoqyvfky .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#naxoqyvfky .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#naxoqyvfky .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#naxoqyvfky .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#naxoqyvfky .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#naxoqyvfky .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#naxoqyvfky .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#naxoqyvfky .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#naxoqyvfky .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#naxoqyvfky .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#naxoqyvfky .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#naxoqyvfky .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#naxoqyvfky .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#naxoqyvfky .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#naxoqyvfky .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#naxoqyvfky .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#naxoqyvfky .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#naxoqyvfky .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#naxoqyvfky .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#naxoqyvfky .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#naxoqyvfky .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#naxoqyvfky .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#naxoqyvfky .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#naxoqyvfky .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#naxoqyvfky .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#naxoqyvfky .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#naxoqyvfky .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#naxoqyvfky .gt_left {\n  text-align: left;\n}\n\n#naxoqyvfky .gt_center {\n  text-align: center;\n}\n\n#naxoqyvfky .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#naxoqyvfky .gt_font_normal {\n  font-weight: normal;\n}\n\n#naxoqyvfky .gt_font_bold {\n  font-weight: bold;\n}\n\n#naxoqyvfky .gt_font_italic {\n  font-style: italic;\n}\n\n#naxoqyvfky .gt_super {\n  font-size: 65%;\n}\n\n#naxoqyvfky .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#naxoqyvfky .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#naxoqyvfky .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#naxoqyvfky .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#naxoqyvfky .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#naxoqyvfky .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#naxoqyvfky .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#naxoqyvfky .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#naxoqyvfky div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <caption><span data-qmd-base64=\"Um90YXZpcnVzIG1vZGVsIHdpdGggc2Vhc29uYWxpdHksIHRyZW5kIGFuZCB2YWNjaW5lIGludGVydmVudGlvbg==\"><span class='gt_from_md'>Rotavirus model with seasonality, trend and vaccine intervention</span></span></caption>\n  <thead>\n    <tr class=\"gt_col_headings gt_spanner_row\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"label\"><span data-qmd-base64=\"KipDaGFyYWN0ZXJpc3RpYyoq\"><span class='gt_from_md'><strong>Characteristic</strong></span></span></th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"3\" scope=\"colgroup\" id=\"level 1; estimate_1\">\n        <div class=\"gt_column_spanner\"><span data-qmd-base64=\"TW9kZWwgd2l0aG91dCBpbnRlcmFjdGlvbiB0ZXJtcw==\"><span class='gt_from_md'>Model without interaction terms</span></span></div>\n      </th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"3\" scope=\"colgroup\" id=\"level 1; estimate_2\">\n        <div class=\"gt_column_spanner\"><span data-qmd-base64=\"SW50ZXJhY3Rpb24gd2l0aCB0cmVuZCBvbmx5\"><span class='gt_from_md'>Interaction with trend only</span></span></div>\n      </th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"3\" scope=\"colgroup\" id=\"level 1; estimate_3\">\n        <div class=\"gt_column_spanner\"><span data-qmd-base64=\"RnVsbCBtb2RlbA==\"><span class='gt_from_md'>Full model</span></span></div>\n      </th>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate_1\"><span data-qmd-base64=\"KipJUlIqKg==\"><span class='gt_from_md'><strong>IRR</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.low_1\"><span data-qmd-base64=\"Kio5NSUgQ0kqKg==\"><span class='gt_from_md'><strong>95% CI</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value_1\"><span data-qmd-base64=\"KipwLXZhbHVlKio=\"><span class='gt_from_md'><strong>p-value</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate_2\"><span data-qmd-base64=\"KipJUlIqKg==\"><span class='gt_from_md'><strong>IRR</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.low_2\"><span data-qmd-base64=\"Kio5NSUgQ0kqKg==\"><span class='gt_from_md'><strong>95% CI</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value_2\"><span data-qmd-base64=\"KipwLXZhbHVlKio=\"><span class='gt_from_md'><strong>p-value</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate_3\"><span data-qmd-base64=\"KipJUlIqKg==\"><span class='gt_from_md'><strong>IRR</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.low_3\"><span data-qmd-base64=\"Kio5NSUgQ0kqKg==\"><span class='gt_from_md'><strong>95% CI</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value_3\"><span data-qmd-base64=\"KipwLXZhbHVlKio=\"><span class='gt_from_md'><strong>p-value</strong></span></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">index</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\">0.9989</td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\">0.9982, 0.9996</td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\">0.001</td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\">1.0015</td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\">1.0003, 1.0027</td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\">0.015</td>\n<td headers=\"estimate_3\" class=\"gt_row gt_center\">1.0006</td>\n<td headers=\"conf.low_3\" class=\"gt_row gt_center\">0.9997, 1.0016</td>\n<td headers=\"p.value_3\" class=\"gt_row gt_center\">0.185</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">sin52</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\">0.4245</td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\">0.3951, 0.4560</td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\"><0.001</td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\">0.4290</td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\">0.4001, 0.4600</td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\"><0.001</td>\n<td headers=\"estimate_3\" class=\"gt_row gt_center\">0.2551</td>\n<td headers=\"conf.low_3\" class=\"gt_row gt_center\">0.2361, 0.2756</td>\n<td headers=\"p.value_3\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">cos52</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\">2.0527</td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\">1.9092, 2.2071</td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\"><0.001</td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\">2.0434</td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\">1.9036, 2.1935</td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\"><0.001</td>\n<td headers=\"estimate_3\" class=\"gt_row gt_center\">2.1715</td>\n<td headers=\"conf.low_3\" class=\"gt_row gt_center\">1.9979, 2.3602</td>\n<td headers=\"p.value_3\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">vaccine</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\">0.4885</td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\">0.4034, 0.5919</td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\"><0.001</td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\">0.9833</td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\">0.7076, 1.3693</td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\">0.919</td>\n<td headers=\"estimate_3\" class=\"gt_row gt_center\">0.9175</td>\n<td headers=\"conf.low_3\" class=\"gt_row gt_center\">0.7086, 1.1897</td>\n<td headers=\"p.value_3\" class=\"gt_row gt_center\">0.504</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\">AIC</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\">5,225</td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\"><br /></td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\"><br /></td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\">5,202</td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\"><br /></td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\"><br /></td>\n<td headers=\"estimate_3\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\">4,945</td>\n<td headers=\"conf.low_3\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\"><br /></td>\n<td headers=\"p.value_3\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Deviance</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\">506</td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\">505</td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"estimate_3\" class=\"gt_row gt_center\">496</td>\n<td headers=\"conf.low_3\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value_3\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Residual df</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\">483</td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\">482</td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"estimate_3\" class=\"gt_row gt_center\">480</td>\n<td headers=\"conf.low_3\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value_3\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">index * vaccine</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\">0.9962</td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\">0.9948, 0.9977</td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\"><0.001</td>\n<td headers=\"estimate_3\" class=\"gt_row gt_center\">0.9971</td>\n<td headers=\"conf.low_3\" class=\"gt_row gt_center\">0.9959, 0.9982</td>\n<td headers=\"p.value_3\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">sin52 * vaccine</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"estimate_3\" class=\"gt_row gt_center\">2.6312</td>\n<td headers=\"conf.low_3\" class=\"gt_row gt_center\">2.3698, 2.9216</td>\n<td headers=\"p.value_3\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">cos52 * vaccine</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"estimate_3\" class=\"gt_row gt_center\">0.8702</td>\n<td headers=\"conf.low_3\" class=\"gt_row gt_center\">0.7800, 0.9709</td>\n<td headers=\"p.value_3\" class=\"gt_row gt_center\">0.010</td></tr>\n  </tbody>\n  <tfoot>\n    <tr class=\"gt_sourcenotes\">\n      <td class=\"gt_sourcenote\" colspan=\"10\"><span data-qmd-base64=\"QWJicmV2aWF0aW9uczogQ0kgPSBDb25maWRlbmNlIEludGVydmFsLCBJUlIgPSBJbmNpZGVuY2UgUmF0ZSBSYXRpbw==\"><span class='gt_from_md'>Abbreviations: CI = Confidence Interval, IRR = Incidence Rate Ratio</span></span></td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\nNow you can keep exploring the impact of vaccination: What about age? Can you see a difference in impact of vaccination depending on age category?\n",
    "supporting": [
      "10-practical_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}