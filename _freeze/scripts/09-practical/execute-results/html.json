{
  "hash": "114d00854c7c2375b72ae58af2646dd0",
  "result": {
    "engine": "knitr",
    "markdown": "# Practical Session 9: The relation between two time series {.unnumbered}\n\n\n\n## Expected learning outcomes {#learn-9 .unnumbered}\n\nBy the end of this session, participants should be able to:\n\n-   assess and interpret associations with external variables\n\n-   identify and interpret effect modification between external variables and the outcome variable in surveillance data\n\n## Task 9.1 {#task-9-1 .unnumbered}\n\nUsing the **aragon** dataset, assess the effect of ambient temperature (using average weekly maximum temperature) on mortality in the autonomous community of Aragón. Is this effect uniform throughout the year?\n\n## Task 9.2 (Optional) {#task-9-2 .unnumbered}\n\nIt has been argued by experts that low temperatures in winter might be “slow killers”; that is, very low temperatures in winter do not result in a peak in mortality on the same day/week as they are observed, but rather after some time has elapsed. On the other hand, very high temperatures in summer are “fast killers”; they are associated with peaks in mortality very fast, i.e. heat waves kill people fast. Can you find evidence for this for Aragón?\n\n## Help for Task 9.1 {#solution-9-1 .unnumbered}\n\nOpen the dataset `aragon.csv`. There you will find mean maximum temperature and mortality data for the autonomous community of Aragon by week.\n\n\n::: {.cell}\n\n```{.r .cell-code}\naragon <- import(here(\"data\", \"aragon.csv\")) \n```\n:::\n\n\nConvert the data to a time series and plot both variables (weekly mean maximum temperature and mortality data).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create ts dataframe with yearweek index\naragonz <- aragon %>% \n  mutate(\n    year_week = make_yearweek(year = year, week = week),\n    index = seq.int(from = 1, to = nrow(aragon))\n  ) %>% \n  as_tsibble(index = index)\n\n# Temperature plot   \naragonz_tmax_plot <- ggplot(data = aragonz) +\n  geom_point(mapping = aes(x = year_week, y = tmax), colour = \"blue\", alpha = 0.5) +\n  scale_y_continuous(limits = c(0, NA)) +\n  scale_x_yearweek(date_labels = \"%Y-%W\", \n                   date_breaks = \"1 year\") +\n  labs(x = \"Week\", \n       y = \"Maximum Temperature\") +\n  tsa_theme\n\n# Mortality plot\naragonz_deaths_plot <- ggplot(data = aragonz) +\n  geom_point(mapping = aes(x = year_week, y = cases), colour = \"green\", alpha = 0.5) +\n  scale_y_continuous(limits = c(0, NA)) +\n  scale_x_yearweek(date_labels = \"%Y-%W\", \n                   date_breaks = \"1 year\") +\n  labs(x = \"Week\", \n       y = \"Weekly deaths counts\") +\n  tsa_theme\n\n# Using patchwork to join the two plots\n# The \"/\" determines an above/below display\naragonz_two_plot <- (aragonz_tmax_plot / aragonz_deaths_plot) \naragonz_two_plot\n```\n\n::: {.cell-output-display}\n![](09-practical_files/figure-html/task-9-1-convert-data-ts-tidy-1.png){width=100%}\n:::\n:::\n\n\nGenerate variables for sine and cosine for annual oscillation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\naragonz <- aragonz %>% \n  mutate(sin52 = sin(2 * pi * date / 52),\n         cos52 = cos(2 * pi * date / 52))\n```\n:::\n\n\nFit a poisson regression model with a simple trend to the weekly number of deaths, accounting for seasonality.\n\n\n::: {.cell}\n\n```{.r .cell-code}\naragmodel1 <- glm(cases ~ index + sin52 + cos52,\n                           family = \"poisson\",\n                           data = aragonz)\n\naragmodel1 %>% \n  gtsummary::tbl_regression(\n    exponentiate = T,\n    estimate_fun = ~style_number(.x, digits = 4)\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"lydmtkamza\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#lydmtkamza table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#lydmtkamza thead, #lydmtkamza tbody, #lydmtkamza tfoot, #lydmtkamza tr, #lydmtkamza td, #lydmtkamza th {\n  border-style: none;\n}\n\n#lydmtkamza p {\n  margin: 0;\n  padding: 0;\n}\n\n#lydmtkamza .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#lydmtkamza .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#lydmtkamza .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#lydmtkamza .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#lydmtkamza .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#lydmtkamza .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lydmtkamza .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#lydmtkamza .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#lydmtkamza .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#lydmtkamza .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#lydmtkamza .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#lydmtkamza .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#lydmtkamza .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#lydmtkamza .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#lydmtkamza .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#lydmtkamza .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#lydmtkamza .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#lydmtkamza .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#lydmtkamza .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lydmtkamza .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#lydmtkamza .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#lydmtkamza .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#lydmtkamza .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lydmtkamza .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#lydmtkamza .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#lydmtkamza .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lydmtkamza .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lydmtkamza .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#lydmtkamza .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lydmtkamza .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#lydmtkamza .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lydmtkamza .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#lydmtkamza .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lydmtkamza .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#lydmtkamza .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lydmtkamza .gt_left {\n  text-align: left;\n}\n\n#lydmtkamza .gt_center {\n  text-align: center;\n}\n\n#lydmtkamza .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#lydmtkamza .gt_font_normal {\n  font-weight: normal;\n}\n\n#lydmtkamza .gt_font_bold {\n  font-weight: bold;\n}\n\n#lydmtkamza .gt_font_italic {\n  font-style: italic;\n}\n\n#lydmtkamza .gt_super {\n  font-size: 65%;\n}\n\n#lydmtkamza .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#lydmtkamza .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#lydmtkamza .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#lydmtkamza .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#lydmtkamza .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#lydmtkamza .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#lydmtkamza .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#lydmtkamza .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#lydmtkamza div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"label\"><span data-qmd-base64=\"KipDaGFyYWN0ZXJpc3RpYyoq\"><span class='gt_from_md'><strong>Characteristic</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate\"><span data-qmd-base64=\"KipJUlIqKg==\"><span class='gt_from_md'><strong>IRR</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.low\"><span data-qmd-base64=\"Kio5NSUgQ0kqKg==\"><span class='gt_from_md'><strong>95% CI</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\"><span data-qmd-base64=\"KipwLXZhbHVlKio=\"><span class='gt_from_md'><strong>p-value</strong></span></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">index</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">1.0001</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">1.0001, 1.0002</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">sin52</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">1.0454</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">1.0364, 1.0545</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">cos52</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">1.1094</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">1.0998, 1.1190</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n  </tbody>\n  <tfoot>\n    <tr class=\"gt_sourcenotes\">\n      <td class=\"gt_sourcenote\" colspan=\"4\"><span data-qmd-base64=\"QWJicmV2aWF0aW9uczogQ0kgPSBDb25maWRlbmNlIEludGVydmFsLCBJUlIgPSBJbmNpZGVuY2UgUmF0ZSBSYXRpbw==\"><span class='gt_from_md'>Abbreviations: CI = Confidence Interval, IRR = Incidence Rate Ratio</span></span></td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\nPlot the predicted weekly number of deaths.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = aragonz) +\n  geom_point(mapping = aes(x = year_week, y = cases), alpha = 0.2) +\n  geom_line(mapping = aes(x = year_week, y = aragmodel1$fitted.values), \n            colour = \"darkorange\", \n            alpha = 0.7, \n            lwd = 1.5) +\n  scale_y_continuous(limits = c(0, NA)) +\n  scale_x_yearweek(date_labels = \"%Y-%W\", \n                   date_breaks = \"1 year\") +\n  labs(x = \"Week\", \n       y = \"Weekly deaths counts\", \n       title = \"Deaths with fitted trend and seasonality\") +\n  tsa_theme\n```\n\n::: {.cell-output-display}\n![](09-practical_files/figure-html/task-9-1-data-lm-model-plot-tidy-1.png){width=100%}\n:::\n:::\n\n\nDiscuss how your model fits the data.\n\n**Note:** When you plotted the weekly number of deaths in Aragon, perhaps you noticed that mortality peaks in winter; however, there are smaller peaks during the summer, too. You can account for that in two different ways: a) include two sine/cosine functions in the model (one for 52-week cycles and one for 26-week cycles), or b) take into account the fact that temperature might be behaving differently as a risk factor in winter than it does in summer (sign of effect modification?).\n\nYou decide to perform your analysis twice; once for winter and once for the rest of the time. You define winter as the time between weeks 49 and 8.\n\n\n::: {.cell}\n\n```{.r .cell-code}\naragonz <- aragonz %>% \n    mutate(winter = (week >= 49 | week <= 8))\n```\n:::\n\n\nFirst run the model including winter as a main effect, and then including an interaction term with temperature.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Model with only main effect\naragmodel2 <- glm(cases ~ index + sin52 + cos52 + winter,\n                           family = \"poisson\",\n                           data = aragonz)\n\n# Model with temperature interaction\naragmodel3 <- glm(cases ~ index + sin52 + cos52 + winter * tmax,\n                           family = \"poisson\",\n                           data = aragonz)\n```\n:::\n\n\nWe compare both model's AIC below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Easiest, most direct way\nAIC(aragmodel2); AIC(aragmodel3)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fancier way using the library gtsummary\ntbl_m2 <- aragmodel2 %>% \n  tbl_regression(exponentiate = TRUE,\n                 estimate_fun = ~style_number(.x, digits = 4)) %>%\n  add_glance_table(include = c(AIC, BIC, deviance))\n\ntbl_m3 <- aragmodel3 %>% \n  tbl_regression(exponentiate = TRUE,\n                 estimate_fun = ~style_number(.x, digits = 4)) %>%\n  add_glance_table(include = c(AIC, BIC, deviance))\n\ntbl_m2m3 <- \n  tbl_merge(\n    tbls = list(tbl_m2, tbl_m3),\n    tab_spanner = c(\"aragmodel2\", \"aragmodel3\")\n  )\ntbl_m2m3\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"wzkhxebmig\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#wzkhxebmig table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#wzkhxebmig thead, #wzkhxebmig tbody, #wzkhxebmig tfoot, #wzkhxebmig tr, #wzkhxebmig td, #wzkhxebmig th {\n  border-style: none;\n}\n\n#wzkhxebmig p {\n  margin: 0;\n  padding: 0;\n}\n\n#wzkhxebmig .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#wzkhxebmig .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#wzkhxebmig .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#wzkhxebmig .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#wzkhxebmig .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#wzkhxebmig .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wzkhxebmig .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#wzkhxebmig .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#wzkhxebmig .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#wzkhxebmig .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#wzkhxebmig .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#wzkhxebmig .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#wzkhxebmig .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#wzkhxebmig .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#wzkhxebmig .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#wzkhxebmig .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#wzkhxebmig .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#wzkhxebmig .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#wzkhxebmig .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wzkhxebmig .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#wzkhxebmig .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#wzkhxebmig .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#wzkhxebmig .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wzkhxebmig .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#wzkhxebmig .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#wzkhxebmig .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wzkhxebmig .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wzkhxebmig .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#wzkhxebmig .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wzkhxebmig .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#wzkhxebmig .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wzkhxebmig .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#wzkhxebmig .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wzkhxebmig .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#wzkhxebmig .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wzkhxebmig .gt_left {\n  text-align: left;\n}\n\n#wzkhxebmig .gt_center {\n  text-align: center;\n}\n\n#wzkhxebmig .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#wzkhxebmig .gt_font_normal {\n  font-weight: normal;\n}\n\n#wzkhxebmig .gt_font_bold {\n  font-weight: bold;\n}\n\n#wzkhxebmig .gt_font_italic {\n  font-style: italic;\n}\n\n#wzkhxebmig .gt_super {\n  font-size: 65%;\n}\n\n#wzkhxebmig .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#wzkhxebmig .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#wzkhxebmig .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#wzkhxebmig .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#wzkhxebmig .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#wzkhxebmig .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#wzkhxebmig .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#wzkhxebmig .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#wzkhxebmig div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings gt_spanner_row\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"label\"><span data-qmd-base64=\"KipDaGFyYWN0ZXJpc3RpYyoq\"><span class='gt_from_md'><strong>Characteristic</strong></span></span></th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"3\" scope=\"colgroup\" id=\"level 1; estimate_1\">\n        <div class=\"gt_column_spanner\"><span data-qmd-base64=\"YXJhZ21vZGVsMg==\"><span class='gt_from_md'>aragmodel2</span></span></div>\n      </th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"3\" scope=\"colgroup\" id=\"level 1; estimate_2\">\n        <div class=\"gt_column_spanner\"><span data-qmd-base64=\"YXJhZ21vZGVsMw==\"><span class='gt_from_md'>aragmodel3</span></span></div>\n      </th>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate_1\"><span data-qmd-base64=\"KipJUlIqKg==\"><span class='gt_from_md'><strong>IRR</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.low_1\"><span data-qmd-base64=\"Kio5NSUgQ0kqKg==\"><span class='gt_from_md'><strong>95% CI</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value_1\"><span data-qmd-base64=\"KipwLXZhbHVlKio=\"><span class='gt_from_md'><strong>p-value</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate_2\"><span data-qmd-base64=\"KipJUlIqKg==\"><span class='gt_from_md'><strong>IRR</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.low_2\"><span data-qmd-base64=\"Kio5NSUgQ0kqKg==\"><span class='gt_from_md'><strong>95% CI</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value_2\"><span data-qmd-base64=\"KipwLXZhbHVlKio=\"><span class='gt_from_md'><strong>p-value</strong></span></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">index</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\">1.0001</td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\">1.0001, 1.0002</td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\"><0.001</td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\">1.0001</td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\">1.0001, 1.0002</td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">sin52</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\">1.0403</td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\">1.0311, 1.0495</td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\"><0.001</td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\">1.0621</td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\">1.0508, 1.0735</td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">cos52</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\">1.0783</td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\">1.0651, 1.0917</td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\"><0.001</td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\">1.1721</td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\">1.1385, 1.2066</td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">winter</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    FALSE</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\">—</td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\">—</td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\">—</td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\">—</td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    TRUE</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\">1.0673</td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\">1.0461, 1.0889</td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\"><0.001</td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\">1.2688</td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\">1.2020, 1.3392</td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\">AIC</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\">4,718</td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\"><br /></td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\"><br /></td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\">4,666</td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\"><br /></td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">BIC</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\">4,739</td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\">4,696</td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Deviance</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\">1,006</td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\">950</td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">tmax</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\">1.0078</td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\">1.0054, 1.0103</td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">winter * tmax</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    TRUE * tmax</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\">0.9849</td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\">0.9806, 0.9893</td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\"><0.001</td></tr>\n  </tbody>\n  <tfoot>\n    <tr class=\"gt_sourcenotes\">\n      <td class=\"gt_sourcenote\" colspan=\"7\"><span data-qmd-base64=\"QWJicmV2aWF0aW9uczogQ0kgPSBDb25maWRlbmNlIEludGVydmFsLCBJUlIgPSBJbmNpZGVuY2UgUmF0ZSBSYXRpbw==\"><span class='gt_from_md'>Abbreviations: CI = Confidence Interval, IRR = Incidence Rate Ratio</span></span></td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\nNote that `winter * tmax` tells R to include terms in the model for `winter`, `tmax` and for their interaction. If we just wanted to include the interaction term without its corresponding \"main effects\", i.e. without `winter` or `tmax`, we would use `winter:tmax` instead.\n\nDiscuss the output of the two models. Does the interpretation change when winter is taken into account as an interaction term along with temperature?\n\n## Help for Task 9.2 {#solution-9-2 .unnumbered}\n\nYou decide to check whether temperature has an effect on mortality with some lag. `stats::lag` is the default base R function to compute lags from the `stats` package. In the example below, we prefer to use one of the tidyverse package alternatives,namely `dplyr::lag`. We specify the package name here to avoid possible conflicts with other packages which have a `lag` function.\n\nWe are using the `lag` function from the `dplyr` package. For a given week, the value of `tmax` is lagged by 1 in respect to the previous week's value.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create lag variable\naragonz <- aragonz %>% \n  mutate(L1.tmax = dplyr::lag(x = tmax, n = 1))\n```\n:::\n\n\nCreate a new model named `aragmodel4` including the lag variable, and compare it with the previous model `aragmodel3`. What can you conclude from it?\n\n\n::: {.cell}\n\n```{.r .cell-code}\naragmodel4 <- glm(cases ~ index + sin52 + cos52 + winter * tmax + L1.tmax,\n                           family = \"poisson\",\n                           data = aragonz)\n\nsummary(aragmodel4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = cases ~ index + sin52 + cos52 + winter * tmax + \n    L1.tmax, family = \"poisson\", data = aragonz)\n\nCoefficients:\n                  Estimate Std. Error z value Pr(>|z|)    \n(Intercept)      5.087e+00  3.198e-02 159.076  < 2e-16 ***\nindex            1.246e-04  2.097e-05   5.942 2.81e-09 ***\nsin52            5.679e-02  6.343e-03   8.954  < 2e-16 ***\ncos52            1.504e-01  1.663e-02   9.043  < 2e-16 ***\nwinterTRUE       2.268e-01  2.795e-02   8.113 4.94e-16 ***\ntmax             8.194e-03  1.304e-03   6.283 3.32e-10 ***\nL1.tmax         -1.226e-03  1.146e-03  -1.070    0.285    \nwinterTRUE:tmax -1.433e-02  2.278e-03  -6.291 3.15e-10 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 1708.45  on 518  degrees of freedom\nResidual deviance:  943.72  on 511  degrees of freedom\n  (1 observation deleted due to missingness)\nAIC: 4654.1\n\nNumber of Fisher Scoring iterations: 4\n```\n\n\n:::\n\n```{.r .cell-code}\nAIC(aragmodel3); AIC(aragmodel4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 4665.836\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 4654.111\n```\n\n\n:::\n:::\n\n\nInstead of running the model with an interaction term, you could run the analyses for winter and the rest of your dataset separately.\n\nThe interaction term was not significant, but you are still curious about the differential effect of temperatures on mortality in winter and the other seasons. You decide to split the data and run two different models for winter and non-winter mortality and temperatures, and compare them.\n\nThink carefully about how you will compare them: are the AIC criteria still valid for this task?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## winter subset\naragonz.winter <- \n    aragonz %>% \n    filter(winter == TRUE)\n\n## not winter subset\naragonz.notwinter <- \n    aragonz %>% \n    filter(winter == FALSE)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Winter model\naragmodel5 <- glm(cases ~ index + sin52 + cos52 + L1.tmax,\n                           family = \"poisson\",\n                           data = aragonz.winter)\n\n# Not winter model\naragmodel6 <- glm(cases ~ index + sin52 + cos52 + L1.tmax,\n                           family = \"poisson\",\n                           data = aragonz.notwinter)\n\n# Table summaries\ntbl_m5 <- aragmodel5 %>% \n  tbl_regression(exponentiate = TRUE,\n                 estimate_fun = ~style_number(.x, digits = 4))\n\ntbl_m6 <- aragmodel6 %>% \n  tbl_regression(exponentiate = TRUE,\n                 estimate_fun = ~style_number(.x, digits = 4))\n\n# Comparison table\ntbl_m5m6 <- \n  tbl_merge(\n    tbls = list(tbl_m5, tbl_m6),\n    tab_spanner = c(\"Winter model\", \"Not winter model\")\n  )\ntbl_m5m6\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"yzdxsktbmj\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#yzdxsktbmj table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#yzdxsktbmj thead, #yzdxsktbmj tbody, #yzdxsktbmj tfoot, #yzdxsktbmj tr, #yzdxsktbmj td, #yzdxsktbmj th {\n  border-style: none;\n}\n\n#yzdxsktbmj p {\n  margin: 0;\n  padding: 0;\n}\n\n#yzdxsktbmj .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#yzdxsktbmj .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#yzdxsktbmj .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#yzdxsktbmj .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#yzdxsktbmj .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#yzdxsktbmj .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#yzdxsktbmj .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#yzdxsktbmj .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#yzdxsktbmj .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#yzdxsktbmj .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#yzdxsktbmj .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#yzdxsktbmj .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#yzdxsktbmj .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#yzdxsktbmj .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#yzdxsktbmj .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#yzdxsktbmj .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#yzdxsktbmj .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#yzdxsktbmj .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#yzdxsktbmj .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yzdxsktbmj .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#yzdxsktbmj .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#yzdxsktbmj .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#yzdxsktbmj .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yzdxsktbmj .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#yzdxsktbmj .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#yzdxsktbmj .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#yzdxsktbmj .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yzdxsktbmj .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#yzdxsktbmj .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#yzdxsktbmj .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#yzdxsktbmj .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#yzdxsktbmj .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#yzdxsktbmj .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yzdxsktbmj .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#yzdxsktbmj .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yzdxsktbmj .gt_left {\n  text-align: left;\n}\n\n#yzdxsktbmj .gt_center {\n  text-align: center;\n}\n\n#yzdxsktbmj .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#yzdxsktbmj .gt_font_normal {\n  font-weight: normal;\n}\n\n#yzdxsktbmj .gt_font_bold {\n  font-weight: bold;\n}\n\n#yzdxsktbmj .gt_font_italic {\n  font-style: italic;\n}\n\n#yzdxsktbmj .gt_super {\n  font-size: 65%;\n}\n\n#yzdxsktbmj .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#yzdxsktbmj .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#yzdxsktbmj .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#yzdxsktbmj .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#yzdxsktbmj .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#yzdxsktbmj .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#yzdxsktbmj .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#yzdxsktbmj .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#yzdxsktbmj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings gt_spanner_row\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"label\"><span data-qmd-base64=\"KipDaGFyYWN0ZXJpc3RpYyoq\"><span class='gt_from_md'><strong>Characteristic</strong></span></span></th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"3\" scope=\"colgroup\" id=\"level 1; estimate_1\">\n        <div class=\"gt_column_spanner\"><span data-qmd-base64=\"V2ludGVyIG1vZGVs\"><span class='gt_from_md'>Winter model</span></span></div>\n      </th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"3\" scope=\"colgroup\" id=\"level 1; estimate_2\">\n        <div class=\"gt_column_spanner\"><span data-qmd-base64=\"Tm90IHdpbnRlciBtb2RlbA==\"><span class='gt_from_md'>Not winter model</span></span></div>\n      </th>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate_1\"><span data-qmd-base64=\"KipJUlIqKg==\"><span class='gt_from_md'><strong>IRR</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.low_1\"><span data-qmd-base64=\"Kio5NSUgQ0kqKg==\"><span class='gt_from_md'><strong>95% CI</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value_1\"><span data-qmd-base64=\"KipwLXZhbHVlKio=\"><span class='gt_from_md'><strong>p-value</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate_2\"><span data-qmd-base64=\"KipJUlIqKg==\"><span class='gt_from_md'><strong>IRR</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.low_2\"><span data-qmd-base64=\"Kio5NSUgQ0kqKg==\"><span class='gt_from_md'><strong>95% CI</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value_2\"><span data-qmd-base64=\"KipwLXZhbHVlKio=\"><span class='gt_from_md'><strong>p-value</strong></span></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">index</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\">1.0002</td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\">1.0001, 1.0003</td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\"><0.001</td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\">1.0001</td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\">1.0001, 1.0002</td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">sin52</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\">1.1944</td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\">1.1428, 1.2486</td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\"><0.001</td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\">1.0485</td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\">1.0348, 1.0624</td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">cos52</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\">1.7229</td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\">1.4361, 2.0675</td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\"><0.001</td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\">1.1094</td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\">1.0785, 1.1412</td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">L1.tmax</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\">0.9923</td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\">0.9879, 0.9967</td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\"><0.001</td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\">1.0031</td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\">1.0006, 1.0055</td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\">0.015</td></tr>\n  </tbody>\n  <tfoot>\n    <tr class=\"gt_sourcenotes\">\n      <td class=\"gt_sourcenote\" colspan=\"7\"><span data-qmd-base64=\"QWJicmV2aWF0aW9uczogQ0kgPSBDb25maWRlbmNlIEludGVydmFsLCBJUlIgPSBJbmNpZGVuY2UgUmF0ZSBSYXRpbw==\"><span class='gt_from_md'>Abbreviations: CI = Confidence Interval, IRR = Incidence Rate Ratio</span></span></td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\nDiscuss the output of the different models. Which one would you go for?\n",
    "supporting": [
      "09-practical_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}